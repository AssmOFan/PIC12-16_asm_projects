MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         INCLUDE MICROMENU_LIB.H
                      00001 ; Микроменю на базе двухстрочного индикатора HD44780 и четырехпозиционного джойстика (крестовины кнопок)
                      00002 ; Библиотека построена на основе "индексов". Меню имеет 2 уровня вложености (вход в пункт меню + вход в 
                            подпункт меню)
                      00003 ; При навигации по меню изменяются номера ("индексы") текущего пункта меню и текущего подпункта меню
                      00004 ; На основе этих данных и выводится информация на дисплей/совершаются действия
                      00005 
Warning[205]: Found directive in column 1. (INCLUDE)
                      00006 INCLUDE HARDWARE_PROFILE.INC
                      00001         INCLUDE P16F84.INC
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F84 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00206         LIST
                      00002         LIST P=16F84
Warning[205]: Found directive in column 1. (INCLUDE)
                      00007 INCLUDE MACRO.H 
                      00001 
                      00002 #DEFINE USE_SHORT_MOD_PCL       1       ; Использовать "укороченную" версию макроса модификации PCL, поз
                            воляет экономить 1 слово памяти на каждом вызове макроса ценой 1 лишней ячейки ОЗУ
                      00003 
                      00004 PUSH    MACRO
                      00005                 MOVWF   W_TEMP
                      00006                 SWAPF   STATUS,W
                      00007                 MOVWF   STATUS_TEMP
                      00008                 ENDM
                      00009 
                      00010 POP             MACRO
                      00011                 SWAPF   STATUS_TEMP,W
                      00012                 MOVWF   STATUS
                      00013                 SWAPF   W_TEMP,F
                      00014                 SWAPF   W_TEMP,W
                      00015                 ENDM
                      00016 
                      00017 MOD_PCL MACRO   TARGET                  ; Макрос, позволяет размещать таблицы на границах страниц
                      00018                 LOCAL   TABLE
                      00019                 MOVFW   TARGET
                      00020                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
                      00021                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                      00022         IF      USE_SHORT_MOD_PCL
                      00023                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
                      00024                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                      00025         ELSE
                      00026                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                      00027                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                      00028                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                      00029         ENDIF
                      00030                 MOVWF   PCLATH                  ; Установить старшую часть адреса
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00031                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
                      00032                 MOVWF   PCL                             ; Установить младшую часть адреса
                      00033         TABLE
                      00034                 ENDM
                      00035 
                      00036 ADD_PCL MACRO   TARGET,ADDRESS  ; Макрос, позволяет удобно указывать страницу для следующего за ним кода
                      00037                                 MOVFW   TARGET  
                      00038                                 CLRF    PCLATH
                      00039                         IF      (ADDRESS==0X100)
                      00040                                 BSF             PCLATH,0
                      00041                         ENDIF
                      00042                         IF      (ADDRESS==0X200)
                      00043                                 BSF             PCLATH,1
                      00044                         ENDIF
                      00045                         IF      (ADDRESS==0X300)
                      00046                                 BSF             PCLATH,0                                
                      00047                                 BSF             PCLATH,1
                      00048                         ENDIF
                      00049                         IF      (ADDRESS==0X400)
                      00050                                 BSF             PCLATH,2                                
                      00051                         ENDIF
                      00052                                 ADDWF   PCL
                      00053                                 ENDM
                      00008 
                      00009 #DEFINE USE_STATIC_CURSOR               0                               ; Всегда рисовать курсор в конце
                             1-й строки
                      00010 #DEFINE USE_MOVING_CURSOR               1                               ; Использовать перемещаемый курс
                            ор (повышает удобство использования меню и размер прошивки)
                      00011 #DEFINE USE_TOP_LAST_CURSOR             1                               ; Использовать отображение "перв
                            ый пункт всегда сверху" и "последний пункт всегда снизу" (повышает удобство использования меню и
                      00012 #DEFINE USE_RBIE                                1                               ; Использовать прерывани
                            е по изминению состояния PORTB для обработки кнопок (позволяет использовать сон)
                      00013 #DEFINE USE_MENU_ACTION                 0                               ; Использовать возможность запус
                            ка действий при входе в пункт меню (повышает размер прошивки)
                      00014 
Warning[205]: Found directive in column 1. (IF)
                      00015 IF      USE_MENU_ACTION 
                      00016 #DEFINE ACTIONS_MENU_FLAGS              B'00000000'             ; Выставленный бит - есть действие при в
                            ходе в этот пункт меню (не забыть заполнить обработчик действия !!!)
                      00017 ENDIF
                      00018 
                      00019 #DEFINE UP                                              PORTB,4
                      00020 #DEFINE DOWN                                    PORTB,5
                      00021 #DEFINE ENTER                                   PORTB,6
                      00022 #DEFINE EXIT                                    PORTB,7
                      00023 
                      00024 #DEFINE PRESS_UP                                FLAGS,0
                      00025 #DEFINE PRESS_DOWN                              FLAGS,1
                      00026 #DEFINE PRESS_EXIT                              FLAGS,2
                      00027 #DEFINE PRESS_ENTER                             FLAGS,3 
                      00028 
                      00029 #DEFINE EXIT_DELAY                              .20                             ; Количество опросов кно
                            пок, до автовыхода в предыдущий уровень (* 0,8 сек)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00030 
                      00031 #DEFINE ZASTAVKA_FIRST_STRING   "  MicroMenuLib"
                      00032 #DEFINE ZASTAVKA_SECOND_STRING  "  ver 1.0 beta"
                      00033 
                      00034 #DEFINE ACTION_COMPLETE_STRING  "Action Complete!"
                      00035 
                      00036 #DEFINE NUM_OF_MAIN_MENU_PUNKTS .5                              ; Количество пунктов меню, до 8 (можно и
                             больше, но действия при входе в меню доступны только для первых 8 пунктов) 
                      00037 
                      00038 #DEFINE MENU_NAME_1                             "1.Menu_1"
                      00039 #DEFINE MENU_NAME_2                             "2.Menu_2"
                      00040 #DEFINE MENU_NAME_3                             "3.Menu_3"
                      00041 #DEFINE MENU_NAME_4                             "4.Menu_4"
                      00042 #DEFINE MENU_NAME_5                             "5.Menu_5"      
                      00043 
                      00044 #DEFINE NUM_OF_SUBMENU_PUNKTS_1 .3                              ; Количество подпунктов каждого пункта м
                            еню (в теории до 64, но больше 8 не проверялось, памяти в контроллере не хватило)
                      00045                                                                                                 ; Не заб
                            ываем оформить обработчик для каждого действия !!!
                      00046 #DEFINE MENU_SUBMENU_NAME_1_1   "1.1.SubMenu"
                      00047 #DEFINE MENU_SUBMENU_NAME_1_2   "1.2.SubMenu"
                      00048 #DEFINE MENU_SUBMENU_NAME_1_3   "1.3.SubMenu"
                      00049 
                      00050 #DEFINE NUM_OF_SUBMENU_PUNKTS_2 .3
                      00051 
                      00052 #DEFINE MENU_SUBMENU_NAME_2_1   "2.1.SubMenu"
                      00053 #DEFINE MENU_SUBMENU_NAME_2_2   "2.2.SubMenu"
                      00054 #DEFINE MENU_SUBMENU_NAME_2_3   "2.3.SubMenu"
                      00055                                 
                      00056 #DEFINE NUM_OF_SUBMENU_PUNKTS_3 .3
                      00057 
                      00058 #DEFINE MENU_SUBMENU_NAME_3_1   "3.1.SubMenu"
                      00059 #DEFINE MENU_SUBMENU_NAME_3_2   "3.2.SubMenu"
                      00060 #DEFINE MENU_SUBMENU_NAME_3_3   "3.3.SubMenu"
                      00061 
                      00062 #DEFINE NUM_OF_SUBMENU_PUNKTS_4 .3
                      00063 
                      00064 #DEFINE MENU_SUBMENU_NAME_4_1   "4.1.SubMenu"
                      00065 #DEFINE MENU_SUBMENU_NAME_4_2   "4.2.SubMenu"
                      00066 #DEFINE MENU_SUBMENU_NAME_4_3   "4.3.SubMenu"
                      00067 
                      00068 #DEFINE NUM_OF_SUBMENU_PUNKTS_5 .3
                      00069 
                      00070 #DEFINE MENU_SUBMENU_NAME_5_1   "5.1.SubMenu"
                      00071 #DEFINE MENU_SUBMENU_NAME_5_2   "5.2.SubMenu"
                      00072 #DEFINE MENU_SUBMENU_NAME_5_3   "5.3.SubMenu"
                      00073 
                      00074 ;=======================================================================================================
                            =========
                      00075 CREATE_MENU_NAMES       MACRO                           ; Макрос, создает имена всех пунктов меню
                      00076                                         LOCAL   A=1
                      00077                                         WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
                      00078                                                 MENU_#V(A)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00079                                                 MOD_PCL SYMBOL_POINTER
                      00080                                                 DT              MENU_NAME_#V(A),0
                      00081                                                 A+=1
                      00082                                         ENDW
                      00083                                         ENDM
                      00084 ;=======================================================================================================
                            =========
                      00085 RETLW_NUM_OF_SUBMENU_PUNKTS     MACRO           ; Макрос, возвращает количество пунктов нужного подменю
                      00086                                                         MOD_PCL INDEX_MENU
                      00087                                                         LOCAL   A=1
                      00088                                                         WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
                      00089                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_#V(A)
                      00090                                                                 A+=1
                      00091                                                         ENDW
                      00092                                                         ENDM
                      00093 ;=======================================================================================================
                            =========
                      00094 GOTO_PUNKT_MENU MACRO                                   ; Макрос, создает переходы на все пункты меню
                      00095                                 MOD_PCL INDEX_MENU
                      00096                                 LOCAL   A=1
                      00097                                 WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
                      00098                                         GOTO    MENU_#V(A)
                      00099                                         A+=1
                      00100                                 ENDW
                      00101                                 ENDM
                      00102 ;=======================================================================================================
                            =========
                      00103 GOTO_PUNKT_SUBMENU      MACRO                           ; Макрос, создает переходы на имена всех подпунк
                            тов меню
                      00104                                         MOD_PCL INDEX_MENU                              
                      00105                                         LOCAL   C=1
                      00106                                         WHILE   C<NUM_OF_MAIN_MENU_PUNKTS+1
                      00107                                                 GOTO    MENU_#V(C)_TABLE
                      00108                                                 C+=1
                      00109                                         ENDW
                      00110                                         LOCAL   D=1
                      00111                                         LOCAL   A
                      00112                                         WHILE           D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00113                                                 A=1     
                      00114                                                 MENU_#V(D)_TABLE
                      00115                                                 MOD_PCL INDEX_SUBMENU
                      00116                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00117                                                         GOTO    MENU_#V(D)_SUBMENU_#V(A)
                      00118                                                         A+=1
                      00119                                                 ENDW
                      00120                                                 D+=1
                      00121                                         ENDW    
                      00122                                         ENDM
                      00123 ;=======================================================================================================
                            =========
                      00124 GOTO_PUNKT_SUBMENU_ACTION       MACRO           ; Макрос, создает переходы на действия всех подпунктов м
                            еню
                      00125                                                         MOD_PCL INDEX_MENU                              
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00126                                                         LOCAL   C=1
                      00127                                                         WHILE   C<NUM_OF_MAIN_MENU_PUNKTS+1
                      00128                                                                 GOTO    MENU_#V(C)_TABLE_ACTION
                      00129                                                                 C+=1
                      00130                                                         ENDW
                      00131                                                         LOCAL   D=1
                      00132                                                         LOCAL   A
                      00133                                                         WHILE           D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00134                                                                 A=1     
                      00135                                                                 MENU_#V(D)_TABLE_ACTION
                      00136                                                                 MOD_PCL INDEX_SUBMENU
                      00137                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00138                                                                         GOTO    MENU_#V(D)_SUBMENU_#V(A)
                            _ACTION
                      00139                                                                         A+=1
                      00140                                                                 ENDW
                      00141                                                                 D+=1
                      00142                                                         ENDW
                      00143                                                         ENDM
                      00144 ;=======================================================================================================
                            =========
                      00145 CREATE_SUBMENU_NAMES    MACRO                           ; Макрос, создает имена всех подпунктов меню
                      00146 ; К сожаления, почему-то не получилось создавать имена всех подпунктов меню в цикле, поэтому приходится 
                            вызывать макрос столько раз, сколько есть пунктов меню
                      00147 ; Внимание, если количество пунктов в меню превышает 8, просто добавьте еще
                      00148                                                 LOCAL   D=1
                      00149 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00150 ; Подпункты 1 пункта меню
                      00151 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00152                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00153                                                         LOCAL   A=1     
                      00154                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00155                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00156                                                                 MOD_PCL SYMBOL_POINTER
                      00157                                                                 DT              MENU_SUBMENU_NAME_1_#V(A
                            ),0
                      00158                                                                 A+=1
                      00159                                                         ENDW
                      00160                                                         D+=1
                      00161                                                 ENDIF
                      00162 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00163 ; Подпункты 2 пункта меню
                      00164 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00165                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00166                                                         LOCAL   A=1     
                      00167                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00168                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00169                                                                 MOD_PCL SYMBOL_POINTER
                      00170                                                                 DT              MENU_SUBMENU_NAME_2_#V(A
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ),0
                      00171                                                                 A+=1
                      00172                                                         ENDW
                      00173                                                         D+=1
                      00174                                                 ENDIF
                      00175 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00176 ; Подпункты 3 пункта меню
                      00177 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00178                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00179                                                         LOCAL   A=1     
                      00180                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00181                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00182                                                                 MOD_PCL SYMBOL_POINTER
                      00183                                                                 DT              MENU_SUBMENU_NAME_3_#V(A
                            ),0
                      00184                                                                 A+=1
                      00185                                                         ENDW
                      00186                                                         D+=1
                      00187                                                 ENDIF
                      00188 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00189 ; Подпункты 4 пункта меню
                      00190 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00191                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00192                                                         LOCAL   A=1     
                      00193                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00194                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00195                                                                 MOD_PCL SYMBOL_POINTER
                      00196                                                                 DT              MENU_SUBMENU_NAME_4_#V(A
                            ),0
                      00197                                                                 A+=1
                      00198                                                         ENDW
                      00199                                                         D+=1
                      00200                                                 ENDIF
                      00201 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00202 ; Подпункты 5 пункта меню
                      00203 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00204                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00205                                                         LOCAL   A=1     
                      00206                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00207                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00208                                                                 MOD_PCL SYMBOL_POINTER
                      00209                                                                 DT              MENU_SUBMENU_NAME_5_#V(A
                            ),0
                      00210                                                                 A+=1
                      00211                                                         ENDW
                      00212                                                         D+=1
                      00213                                                 ENDIF
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00214 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00215 ; Подпункты 6 пункта меню
                      00216 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00217                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00218                                                         LOCAL   A=1     
                      00219                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00220                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00221                                                                 MOD_PCL SYMBOL_POINTER
                      00222                                                                 DT              MENU_SUBMENU_NAME_5_#V(A
                            ),0
                      00223                                                                 A+=1
                      00224                                                         ENDW
                      00225                                                         D+=1
                      00226                                                 ENDIF
                      00227 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00228 ; Подпункты 7 пункта меню
                      00229 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00230                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00231                                                         LOCAL   A=1     
                      00232                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00233                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00234                                                                 MOD_PCL SYMBOL_POINTER
                      00235                                                                 DT              MENU_SUBMENU_NAME_5_#V(A
                            ),0
                      00236                                                                 A+=1
                      00237                                                         ENDW
                      00238                                                         D+=1
                      00239                                                 ENDIF
                      00240 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00241 ; Подпункты 8 пункта меню
                      00242 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00243                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                      00244                                                         LOCAL   A=1     
                      00245                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_#V(D)+1
                      00246                                                                 MENU_#V(D)_SUBMENU_#V(A)
                      00247                                                                 MOD_PCL SYMBOL_POINTER
                      00248                                                                 DT              MENU_SUBMENU_NAME_5_#V(A
                            ),0
                      00249                                                                 A+=1
                      00250                                                         ENDW
                      00251                                                         D+=1
                      00252                                                 ENDIF
                      00253 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00254                                                 ENDM
                      00255 ;=======================================================================================================
                            =========
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (IF)
                      00256 IF      USE_MENU_ACTION 
                      00257 GOTO_MENU_ACTION        MACRO           ; Макрос, создает переходы на действия всех пунктов меню (если в
                            ключена соответствующая опция)
                      00258                                         MOD_PCL INDEX_MENU                              
                      00259                                         LOCAL   A=1
                      00260                                         WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
                      00261                                                 GOTO    MENU_0_ACTION
                      00262                                                 A+=1
                      00263                                         ENDW
                      00264                                         ENDM
                      00265 ENDIF
                      00002         INCLUDE HD44780_LIB.H
Warning[205]: Found directive in column 1. (INCLUDE)
                      00001 INCLUDE HARDWARE_PROFILE.INC
                      00003         INCLUDE P16F84.INC
                      00207         LIST
                      00208 
                      00209 ;==========================================================================
                      00210 ;  MPASM PIC16F84 processor include
                      00211 ; 
                      00212 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00213 ;==========================================================================
                      00214 
Message[310]: Superseding current maximum RAM and RAM map.
                      00412         LIST
                      00004         LIST P=16F84
                      00002 
  00000001            00003 Y                               EQU             1                               ; YES
  00000000            00004 N                               EQU             0                               ; NO
                      00005 
  00000001            00006 USE_4_BIT_MODE  EQU             Y                               ; YES/NO
  00000000            00007 USE_HIGH_NIBLE  EQU             N                               ; YES/NO
  00000000            00008 USE_ONE_PORT    EQU             N                               ; YES/NO
  00000001            00009 ONLY_WRITE              EQU             Y                               ; YES/NO
                      00010 
  00000006            00011 LCD_DATA                EQU             PORTB                   ; Описываем порт линий данных
  00000086            00012 LCD_DATA_TRIS   EQU             TRISB
                      00013 
                      00014         IF      (USE_4_BIT_MODE && USE_ONE_PORT); ; Если используем один порт для данных и линий управле
                            ниЯ
                      00015 
                      00016 LCD_CNTL                EQU             LCD_DATA                ; то так и опишем
                      00017 LCD_CNTL_TRIS   EQU             LCD_DATA_TRIS
                      00018 
                      00019         ELSE
                      00020 
  00000005            00021 LCD_CNTL                EQU             PORTA                   ; Иначе зададим любой другой
  00000085            00022 LCD_CNTL_TRIS   EQU             TRISA
                      00023         ENDIF
                      00024         
                      00025         IF      (USE_4_BIT_MODE && USE_ONE_PORT && USE_HIGH_NIBLE && ONLY_WRITE)
                      00026 E                               EQU             2
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00027 RS                              EQU             3
                      00028 CNTL_TRIS_MASK  EQU             B'11110011'             ; Маска настройки линий управлениЯ
                      00029         ENDIF
                      00030 
                      00031         IF      (USE_4_BIT_MODE && USE_ONE_PORT && USE_HIGH_NIBLE && !ONLY_WRITE)
                      00032 E                               EQU             1
                      00033 RW                              EQU             2
                      00034 RS                              EQU             3
                      00035 CNTL_TRIS_MASK  EQU             B'11110001'             ; Маска настройки линий управлениЯ
                      00036         ENDIF   
                      00037 
                      00038         IF      (USE_4_BIT_MODE && USE_ONE_PORT && !USE_HIGH_NIBLE && ONLY_WRITE)
                      00039 E                               EQU             4
                      00040 RS                              EQU             5
                      00041 CNTL_TRIS_MASK  EQU             B'11001111'             ; Маска настройки линий управлениЯ
                      00042         ENDIF   
                      00043 
                      00044         IF      (USE_4_BIT_MODE && USE_ONE_PORT && !USE_HIGH_NIBLE && !ONLY_WRITE)
                      00045 E                               EQU             4
                      00046 RW                              EQU             5
                      00047 RS                              EQU             6
                      00048 CNTL_TRIS_MASK  EQU             B'10001111'             ; Маска настройки линий управлениЯ
                      00049 
                      00050         ELSE    ; Иначе присваиваем контрольным линиям любой другой порт и вибираем линии их по своему у
                            смотрению
                      00051         
  00000001            00052 E                               EQU             1
  00000003            00053 RS                              EQU             3
  000000F5            00054 CNTL_TRIS_MASK  EQU             B'11110101'             ; Маска настройки линий управления
                      00055         ENDIF
                      00056 
  0000000C            00057 DISP_ON                 EQU             B'00001100'             ; Display on
  0000000E            00058 DISP_ON_C               EQU             B'00001110'             ; Display on, Cursor on
  0000000F            00059 DISP_ON_B               EQU             B'00001111'             ; Display on, Cursor on, Blink cursor
  00000008            00060 DISP_OFF                EQU             B'00001000'             ; Display off
  00000001            00061 CLR_DISP                EQU             B'00000001'             ; Clear the Display
  00000006            00062 ENTRY_INC               EQU             B'00000110'             ; автоинкремент адреса, нет сдвига 
  00000007            00063 ENTRY_INC_S             EQU             B'00000111'             ; автоинкремент адреса, есть сдвиг
  00000004            00064 ENTRY_DEC               EQU             B'00000100'             ; автоинкремент адреса, нет сдвига 
  00000005            00065 ENTRY_DEC_S             EQU             B'00000101'             ;
  00000080            00066 DD_RAM_ADDR             EQU             B'10000000'             ; Least Significant 7-bit are for addres
                            s
  00000080            00067 DD_RAM_UL               EQU             B'10000000'             ; Upper Left coner of the Display
  000000C0            00068 SECOND_LINE             EQU             B'11000000'             ; Move cursor to second line
                      00069                                         
                      00003 
                      00004 MICROMENU_LIB_UDATA     UDATA_SHR
0000                  00005 INDEX_MENU              RES     1
0001                  00006 INDEX_SUBMENU   RES     1
0002                  00007 SYMBOL_POINTER  RES     1
0003                  00008 MENU_COUNTER    RES     1
0004                  00009 TEMP_1                  RES     1
0005                  00010 TEMP_2                  RES     1
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0006                  00011 TEMP_3                  RES     1
                      00012 
Warning[205]: Found directive in column 1. (EXTERN)
  0000                00013 EXTERN  FLAGS,OFFSET
                      00014 
                      00015         IF      USE_SHORT_MOD_PCL                               ; Если используется "укороченная" версия
                             макроса модификации PCL
Warning[205]: Found directive in column 1. (EXTERN)
  0000                00016 EXTERN  KNOWN_ZERO
                      00017         ENDIF
                      00018 
  0000                00019         GLOBAL  MENU_HEANDLER,ZASTAVKA
  0000                00020         EXTERN  SEND_LCD_SYMBOL,SEND_LCD_COMMAND,DELAY_4MS,MAIN
                      00021 ;===================================================================================================
                      00022 MICROMENU               CODE                                    ; Сегмент кода библиотеки меню
                      00023 ;===================================================================================================
0000                  00024 TABLE_ACTION_COMPLETE 
                      00025         MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0000   08??               M                 MOVFW   SYMBOL_POINTER
0001   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0002   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0003   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0004   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0005   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0006   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0007   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0008                      M         TABLE
0008   3441 3463 3474 00026         DT              ACTION_COMPLETE_STRING,0
       3469 346F 346E 
       3420 3443 346F 
       346D 3470 346C 
       3465 3474 3465 
       3421 3400 
                      00027 
0019                  00028 TABLE_ZASTAVKA_FIRST_STRING
                      00029         MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0019   08??               M                 MOVFW   SYMBOL_POINTER
001A   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
001B   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
001C   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
001D   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
001E   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
001F   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0020   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0021                      M         TABLE
0021   3420 3420 344D 00030         DT              ZASTAVKA_FIRST_STRING,0
       3469 3463 3472 
       346F 344D 3465 
       346E 3475 344C 
       3469 3462 3400 
                      00031 
0030                  00032 TABLE_ZASTAVKA_SECOND_STRING 
                      00033         MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0030   08??               M                 MOVFW   SYMBOL_POINTER
0031   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0032   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0033   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0034   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0035   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0036   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0037   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0038                      M         TABLE
0038   3420 3420 3476 00034         DT              ZASTAVKA_SECOND_STRING,0
       3465 3472 3420 
       3431 342E 3430 
       3420 3462 3465 
       3474 3461 3400 
                      00035 ;===================================================================================================
0047                  00036 NUM_OF_SUBMENU_TABLE                                    
                      00037         RETLW_NUM_OF_SUBMENU_PUNKTS                     ; Макрос, возвращает количество подпунктов текущ
                            его пункта меню
                          M                                                         MOD_PCL INDEX_MENU
  0000                    M                 LOCAL   TABLE
0047   08??               M                 MOVFW   INDEX_MENU
0048   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0049   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
004A   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
004B   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
004C   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
004D   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
004E   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
004F                      M         TABLE
  0001                    M                                                         LOCAL   A=1
                          M                                                         WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
004F   3403               M                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
0050   3403               M                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                 A+=1
0051   3403               M                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
0052   3403               M                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_4
Warning[207]: Found label after column 1. (A)
  00000005                M                                                                 A+=1
0053   3403               M                                                                 RETLW   NUM_OF_SUBMENU_PUNKTS_5
Warning[207]: Found label after column 1. (A)
  00000006                M                                                                 A+=1
                          M                                                         ENDW
                      00038 ;===================================================================================================
0054                  00039 SWITCH_MENU_TABLE                                               ; Переходим на нужный пункт меню
                      00040         GOTO_PUNKT_MENU                                         ; Макрос, создает переходы на все пункты
                             меню                                           
                          M                                 MOD_PCL INDEX_MENU
  0000                    M                 LOCAL   TABLE
0054   08??               M                 MOVFW   INDEX_MENU
0055   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0056   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0057   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0058   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0059   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
005A   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
005B   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
005C                      M         TABLE
  0001                    M                                 LOCAL   A=1
                          M                                 WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
005C   2???               M                                         GOTO    MENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                         A+=1
005D   2???               M                                         GOTO    MENU_2
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[207]: Found label after column 1. (A)
  00000003                M                                         A+=1
005E   2???               M                                         GOTO    MENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                         A+=1
005F   2???               M                                         GOTO    MENU_4
Warning[207]: Found label after column 1. (A)
  00000005                M                                         A+=1
0060   2???               M                                         GOTO    MENU_5
Warning[207]: Found label after column 1. (A)
  00000006                M                                         A+=1
                          M                                 ENDW
                      00041 ;---------------------------------------------------------------------------------------------------
0061                  00042 SWITCH_SUBMENU_TABLE                                    ; Переходим на нужный подпункт меню
                      00043         GOTO_PUNKT_SUBMENU                                      ; Макрос, создает переходы на все подпун
                            кты меню
                          M                                         MOD_PCL INDEX_MENU                              
  0000                    M                 LOCAL   TABLE
0061   08??               M                 MOVFW   INDEX_MENU
0062   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0063   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0064   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0065   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0066   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0067   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0068   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0069                      M         TABLE
  0001                    M                                         LOCAL   C=1
                          M                                         WHILE   C<NUM_OF_MAIN_MENU_PUNKTS+1
0069   2???               M                                                 GOTO    MENU_1_TABLE
Warning[207]: Found label after column 1. (C)
  00000002                M                                                 C+=1
006A   2???               M                                                 GOTO    MENU_2_TABLE
Warning[207]: Found label after column 1. (C)
  00000003                M                                                 C+=1
006B   2???               M                                                 GOTO    MENU_3_TABLE
Warning[207]: Found label after column 1. (C)
  00000004                M                                                 C+=1
006C   2???               M                                                 GOTO    MENU_4_TABLE
Warning[207]: Found label after column 1. (C)
  00000005                M                                                 C+=1
006D   2???               M                                                 GOTO    MENU_5_TABLE
Warning[207]: Found label after column 1. (C)
  00000006                M                                                 C+=1
                          M                                         ENDW
  0001                    M                                         LOCAL   D=1
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M                                         LOCAL   A
                          M                                         WHILE           D<NUM_OF_MAIN_MENU_PUNKTS+1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                 A=1     
Warning[207]: Found label after column 1. (MENU_1_TABLE)
006E                      M                                                 MENU_1_TABLE
                          M                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
006E   08??               M                 MOVFW   INDEX_SUBMENU
006F   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0070   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0071   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0072   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0073   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0074   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0075   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0076                      M         TABLE
                          M                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_1+1
0076   2???               M                                                         GOTO    MENU_1_SUBMENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                         A+=1
0077   2???               M                                                         GOTO    MENU_1_SUBMENU_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                         A+=1
0078   2???               M                                                         GOTO    MENU_1_SUBMENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                         A+=1
                          M                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000002                M                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                 A=1     
Warning[207]: Found label after column 1. (MENU_2_TABLE)
0079                      M                                                 MENU_2_TABLE
                          M                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
0079   08??               M                 MOVFW   INDEX_SUBMENU
007A   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
007B   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
007C   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
007D   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         ENDIF
007E   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
007F   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0080   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0081                      M         TABLE
                          M                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_2+1
0081   2???               M                                                         GOTO    MENU_2_SUBMENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                         A+=1
0082   2???               M                                                         GOTO    MENU_2_SUBMENU_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                         A+=1
0083   2???               M                                                         GOTO    MENU_2_SUBMENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                         A+=1
                          M                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000003                M                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                 A=1     
Warning[207]: Found label after column 1. (MENU_3_TABLE)
0084                      M                                                 MENU_3_TABLE
                          M                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
0084   08??               M                 MOVFW   INDEX_SUBMENU
0085   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0086   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0087   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0088   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0089   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
008A   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
008B   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
008C                      M         TABLE
                          M                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_3+1
008C   2???               M                                                         GOTO    MENU_3_SUBMENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                         A+=1
008D   2???               M                                                         GOTO    MENU_3_SUBMENU_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                         A+=1
008E   2???               M                                                         GOTO    MENU_3_SUBMENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                         A+=1
                          M                                                 ENDW
Warning[207]: Found label after column 1. (D)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000004                M                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                 A=1     
Warning[207]: Found label after column 1. (MENU_4_TABLE)
008F                      M                                                 MENU_4_TABLE
                          M                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
008F   08??               M                 MOVFW   INDEX_SUBMENU
0090   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0091   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0092   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0093   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0094   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0095   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0096   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0097                      M         TABLE
                          M                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_4+1
0097   2???               M                                                         GOTO    MENU_4_SUBMENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                         A+=1
0098   2???               M                                                         GOTO    MENU_4_SUBMENU_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                         A+=1
0099   2???               M                                                         GOTO    MENU_4_SUBMENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                         A+=1
                          M                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000005                M                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                 A=1     
Warning[207]: Found label after column 1. (MENU_5_TABLE)
009A                      M                                                 MENU_5_TABLE
                          M                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
009A   08??               M                 MOVFW   INDEX_SUBMENU
009B   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
009C   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
009D   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
009E   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

009F   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00A0   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00A1   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00A2                      M         TABLE
                          M                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_5+1
00A2   2???               M                                                         GOTO    MENU_5_SUBMENU_1
Warning[207]: Found label after column 1. (A)
  00000002                M                                                         A+=1
00A3   2???               M                                                         GOTO    MENU_5_SUBMENU_2
Warning[207]: Found label after column 1. (A)
  00000003                M                                                         A+=1
00A4   2???               M                                                         GOTO    MENU_5_SUBMENU_3
Warning[207]: Found label after column 1. (A)
  00000004                M                                                         A+=1
                          M                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000006                M                                                 D+=1
                          M                                         ENDW    
                      00044 ;---------------------------------------------------------------------------------------------------
00A5                  00045 SWITCH_ACTION                                                   ; Выполним действие, на котором находитс
                            я курсор 
                      00046         GOTO_PUNKT_SUBMENU_ACTION                       ; Макрос, создает переходы на действия всех подп
                            унктов меню
                          M                                                         MOD_PCL INDEX_MENU                              
  0000                    M                 LOCAL   TABLE
00A5   08??               M                 MOVFW   INDEX_MENU
00A6   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00A7   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00A8   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00A9   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00AA   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00AB   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00AC   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00AD                      M         TABLE
  0001                    M                                                         LOCAL   C=1
                          M                                                         WHILE   C<NUM_OF_MAIN_MENU_PUNKTS+1
00AD   2???               M                                                                 GOTO    MENU_1_TABLE_ACTION
Warning[207]: Found label after column 1. (C)
  00000002                M                                                                 C+=1
00AE   2???               M                                                                 GOTO    MENU_2_TABLE_ACTION
Warning[207]: Found label after column 1. (C)
  00000003                M                                                                 C+=1
00AF   2???               M                                                                 GOTO    MENU_3_TABLE_ACTION
Warning[207]: Found label after column 1. (C)
  00000004                M                                                                 C+=1
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00B0   2???               M                                                                 GOTO    MENU_4_TABLE_ACTION
Warning[207]: Found label after column 1. (C)
  00000005                M                                                                 C+=1
00B1   2???               M                                                                 GOTO    MENU_5_TABLE_ACTION
Warning[207]: Found label after column 1. (C)
  00000006                M                                                                 C+=1
                          M                                                         ENDW
  0001                    M                                                         LOCAL   D=1
  0000                    M                                                         LOCAL   A
                          M                                                         WHILE           D<NUM_OF_MAIN_MENU_PUNKTS+1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                                 A=1     
Warning[207]: Found label after column 1. (MENU_1_TABLE_ACTION)
00B2                      M                                                                 MENU_1_TABLE_ACTION
                          M                                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
00B2   08??               M                 MOVFW   INDEX_SUBMENU
00B3   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00B4   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00B5   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00B6   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00B7   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00B8   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00B9   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00BA                      M         TABLE
                          M                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_1+1
00BA   2???               M                                                                         GOTO    MENU_1_SUBMENU_1_ACTION
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                         A+=1
00BB   2???               M                                                                         GOTO    MENU_1_SUBMENU_2_ACTION
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                         A+=1
00BC   2???               M                                                                         GOTO    MENU_1_SUBMENU_3_ACTION
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                         A+=1
                          M                                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000002                M                                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                                 A=1     
Warning[207]: Found label after column 1. (MENU_2_TABLE_ACTION)
00BD                      M                                                                 MENU_2_TABLE_ACTION
                          M                                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
00BD   08??               M                 MOVFW   INDEX_SUBMENU
00BE   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00BF   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00C0   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00C1   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00C2   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00C3   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00C4   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00C5                      M         TABLE
                          M                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_2+1
00C5   2???               M                                                                         GOTO    MENU_2_SUBMENU_1_ACTION
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                         A+=1
00C6   2???               M                                                                         GOTO    MENU_2_SUBMENU_2_ACTION
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                         A+=1
00C7   2???               M                                                                         GOTO    MENU_2_SUBMENU_3_ACTION
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                         A+=1
                          M                                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000003                M                                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                                 A=1     
Warning[207]: Found label after column 1. (MENU_3_TABLE_ACTION)
00C8                      M                                                                 MENU_3_TABLE_ACTION
                          M                                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
00C8   08??               M                 MOVFW   INDEX_SUBMENU
00C9   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00CA   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00CB   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00CC   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00CD   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00CE   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00CF   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00D0                      M         TABLE
                          M                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_3+1
00D0   2???               M                                                                         GOTO    MENU_3_SUBMENU_1_ACTION
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                         A+=1
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00D1   2???               M                                                                         GOTO    MENU_3_SUBMENU_2_ACTION
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                         A+=1
00D2   2???               M                                                                         GOTO    MENU_3_SUBMENU_3_ACTION
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                         A+=1
                          M                                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000004                M                                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                                 A=1     
Warning[207]: Found label after column 1. (MENU_4_TABLE_ACTION)
00D3                      M                                                                 MENU_4_TABLE_ACTION
                          M                                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
00D3   08??               M                 MOVFW   INDEX_SUBMENU
00D4   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00D5   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00D6   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00D7   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00D8   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00D9   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00DA   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00DB                      M         TABLE
                          M                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_4+1
00DB   2???               M                                                                         GOTO    MENU_4_SUBMENU_1_ACTION
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                         A+=1
00DC   2???               M                                                                         GOTO    MENU_4_SUBMENU_2_ACTION
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                         A+=1
00DD   2???               M                                                                         GOTO    MENU_4_SUBMENU_3_ACTION
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                         A+=1
                          M                                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000005                M                                                                 D+=1
Warning[207]: Found label after column 1. (A)
  00000001                M                                                                 A=1     
Warning[207]: Found label after column 1. (MENU_5_TABLE_ACTION)
00DE                      M                                                                 MENU_5_TABLE_ACTION
                          M                                                                 MOD_PCL INDEX_SUBMENU
  0000                    M                 LOCAL   TABLE
00DE   08??               M                 MOVFW   INDEX_SUBMENU
00DF   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00E0   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         IF      USE_SHORT_MOD_PCL
00E1   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00E2   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00E3   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00E4   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00E5   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00E6                      M         TABLE
                          M                                                                 WHILE   A<NUM_OF_SUBMENU_PUNKTS_5+1
00E6   2???               M                                                                         GOTO    MENU_5_SUBMENU_1_ACTION
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                         A+=1
00E7   2???               M                                                                         GOTO    MENU_5_SUBMENU_2_ACTION
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                         A+=1
00E8   2???               M                                                                         GOTO    MENU_5_SUBMENU_3_ACTION
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                         A+=1
                          M                                                                 ENDW
Warning[207]: Found label after column 1. (D)
  00000006                M                                                                 D+=1
                          M                                                         ENDW
                      00047 ;===================================================================================================
                      00048         CREATE_MENU_NAMES                                       ; Макрос, создает имена всех пунктов мен
                            ю
  0001                    M                                         LOCAL   A=1
                          M                                         WHILE   A<NUM_OF_MAIN_MENU_PUNKTS+1
Warning[207]: Found label after column 1. (MENU_1)
00E9                      M                                                 MENU_1
                          M                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
00E9   08??               M                 MOVFW   SYMBOL_POINTER
00EA   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00EB   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00EC   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00ED   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00EE   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
00EF   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
00F0   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
00F1                      M         TABLE
00F1   3431 342E 344D     M                                                 DT              MENU_NAME_1,0
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3465 346E 3475 
       345F 3431 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                 A+=1
Warning[207]: Found label after column 1. (MENU_2)
00FA                      M                                                 MENU_2
                          M                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
00FA   08??               M                 MOVFW   SYMBOL_POINTER
00FB   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
00FC   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
00FD   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
00FE   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
00FF   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0100   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0101   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0102                      M         TABLE
0102   3432 342E 344D     M                                                 DT              MENU_NAME_2,0
       3465 346E 3475 
       345F 3432 3400 
Warning[207]: Found label after column 1. (A)
  00000003                M                                                 A+=1
Warning[207]: Found label after column 1. (MENU_3)
010B                      M                                                 MENU_3
                          M                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
010B   08??               M                 MOVFW   SYMBOL_POINTER
010C   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
010D   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
010E   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
010F   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0110   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0111   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0112   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0113                      M         TABLE
0113   3433 342E 344D     M                                                 DT              MENU_NAME_3,0
       3465 346E 3475 
       345F 3433 3400 
Warning[207]: Found label after column 1. (A)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000004                M                                                 A+=1
Warning[207]: Found label after column 1. (MENU_4)
011C                      M                                                 MENU_4
                          M                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
011C   08??               M                 MOVFW   SYMBOL_POINTER
011D   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
011E   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
011F   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0120   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0121   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0122   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0123   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0124                      M         TABLE
0124   3434 342E 344D     M                                                 DT              MENU_NAME_4,0
       3465 346E 3475 
       345F 3434 3400 
Warning[207]: Found label after column 1. (A)
  00000005                M                                                 A+=1
Warning[207]: Found label after column 1. (MENU_5)
012D                      M                                                 MENU_5
                          M                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
012D   08??               M                 MOVFW   SYMBOL_POINTER
012E   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
012F   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0130   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0131   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0132   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0133   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0134   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0135                      M         TABLE
0135   3435 342E 344D     M                                                 DT              MENU_NAME_5,0
       3465 346E 3475 
       345F 3435 3400 
Warning[207]: Found label after column 1. (A)
  00000006                M                                                 A+=1
                          M                                         ENDW
                      00049 ;===================================================================================================
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00050         CREATE_SUBMENU_NAMES                            ; Макрос, создает имена всех подпунктов меню
                          M ; К сожаления, почему-то не получилось создавать имена всех подпунктов меню в цикле, поэтому приходится 
                            вызывать макрос столько раз, сколько есть пунктов меню
                          M ; Внимание, если количество пунктов в меню превышает 8, просто добавьте еще
  0001                    M                                                 LOCAL   D=1
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 1 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_1+1
Warning[207]: Found label after column 1. (MENU_1_SUBMENU_1)
013E                      M                                                                 MENU_1_SUBMENU_1
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
013E   08??               M                 MOVFW   SYMBOL_POINTER
013F   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0140   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0141   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0142   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0143   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0144   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0145   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0146                      M         TABLE
0146   3431 342E 3431     M                                                                 DT              MENU_SUBMENU_NAME_1_1,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_1_SUBMENU_2)
0152                      M                                                                 MENU_1_SUBMENU_2
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0152   08??               M                 MOVFW   SYMBOL_POINTER
0153   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0154   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0155   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0156   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         ENDIF
0157   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0158   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0159   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
015A                      M         TABLE
015A   3431 342E 3432     M                                                                 DT              MENU_SUBMENU_NAME_1_2,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_1_SUBMENU_3)
0166                      M                                                                 MENU_1_SUBMENU_3
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0166   08??               M                 MOVFW   SYMBOL_POINTER
0167   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0168   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0169   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
016A   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
016B   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
016C   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
016D   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
016E                      M         TABLE
016E   3431 342E 3433     M                                                                 DT              MENU_SUBMENU_NAME_1_3,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
                          M                                                         ENDW
Warning[207]: Found label after column 1. (D)
  00000002                M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 2 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_2+1
Warning[207]: Found label after column 1. (MENU_2_SUBMENU_1)
017A                      M                                                                 MENU_2_SUBMENU_1
                          M                                                                 MOD_PCL SYMBOL_POINTER
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M                 LOCAL   TABLE
017A   08??               M                 MOVFW   SYMBOL_POINTER
017B   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
017C   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
017D   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
017E   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
017F   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0180   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0181   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0182                      M         TABLE
0182   3432 342E 3431     M                                                                 DT              MENU_SUBMENU_NAME_2_1,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_2_SUBMENU_2)
018E                      M                                                                 MENU_2_SUBMENU_2
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
018E   08??               M                 MOVFW   SYMBOL_POINTER
018F   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0190   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0191   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0192   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0193   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0194   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0195   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0196                      M         TABLE
0196   3432 342E 3432     M                                                                 DT              MENU_SUBMENU_NAME_2_2,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_2_SUBMENU_3)
01A2                      M                                                                 MENU_2_SUBMENU_3
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01A2   08??               M                 MOVFW   SYMBOL_POINTER
01A3   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
01A4   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
01A5   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
01A6   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
01A7   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
01A8   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
01A9   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
01AA                      M         TABLE
01AA   3432 342E 3433     M                                                                 DT              MENU_SUBMENU_NAME_2_3,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
                          M                                                         ENDW
Warning[207]: Found label after column 1. (D)
  00000003                M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 3 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_3+1
Warning[207]: Found label after column 1. (MENU_3_SUBMENU_1)
01B6                      M                                                                 MENU_3_SUBMENU_1
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
01B6   08??               M                 MOVFW   SYMBOL_POINTER
01B7   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
01B8   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
01B9   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
01BA   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
01BB   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
01BC   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
01BD   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01BE                      M         TABLE
01BE   3433 342E 3431     M                                                                 DT              MENU_SUBMENU_NAME_3_1,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_3_SUBMENU_2)
01CA                      M                                                                 MENU_3_SUBMENU_2
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
01CA   08??               M                 MOVFW   SYMBOL_POINTER
01CB   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
01CC   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
01CD   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
01CE   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
01CF   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
01D0   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
01D1   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
01D2                      M         TABLE
01D2   3433 342E 3432     M                                                                 DT              MENU_SUBMENU_NAME_3_2,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_3_SUBMENU_3)
01DE                      M                                                                 MENU_3_SUBMENU_3
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
01DE   08??               M                 MOVFW   SYMBOL_POINTER
01DF   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
01E0   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
01E1   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
01E2   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
01E3   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
01E4   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
01E5   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
01E6                      M         TABLE
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01E6   3433 342E 3433     M                                                                 DT              MENU_SUBMENU_NAME_3_3,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
                          M                                                         ENDW
Warning[207]: Found label after column 1. (D)
  00000004                M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 4 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_4+1
Warning[207]: Found label after column 1. (MENU_4_SUBMENU_1)
01F2                      M                                                                 MENU_4_SUBMENU_1
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
01F2   08??               M                 MOVFW   SYMBOL_POINTER
01F3   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
01F4   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
01F5   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
01F6   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
01F7   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
01F8   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
01F9   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
01FA                      M         TABLE
01FA   3434 342E 3431     M                                                                 DT              MENU_SUBMENU_NAME_4_1,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_4_SUBMENU_2)
0206                      M                                                                 MENU_4_SUBMENU_2
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0206   08??               M                 MOVFW   SYMBOL_POINTER
0207   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0208   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0209   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

020A   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
020B   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
020C   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
020D   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
020E                      M         TABLE
020E   3434 342E 3432     M                                                                 DT              MENU_SUBMENU_NAME_4_2,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000003                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_4_SUBMENU_3)
021A                      M                                                                 MENU_4_SUBMENU_3
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
021A   08??               M                 MOVFW   SYMBOL_POINTER
021B   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
021C   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
021D   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
021E   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
021F   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0220   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0221   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0222                      M         TABLE
0222   3434 342E 3433     M                                                                 DT              MENU_SUBMENU_NAME_4_3,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
                          M                                                         ENDW
Warning[207]: Found label after column 1. (D)
  00000005                M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 5 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0001                    M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_5+1
Warning[207]: Found label after column 1. (MENU_5_SUBMENU_1)
022E                      M                                                                 MENU_5_SUBMENU_1
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
022E   08??               M                 MOVFW   SYMBOL_POINTER
022F   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0230   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0231   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0232   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0233   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0234   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0235   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
0236                      M         TABLE
0236   3435 342E 3431     M                                                                 DT              MENU_SUBMENU_NAME_5_1,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000002                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_5_SUBMENU_2)
0242                      M                                                                 MENU_5_SUBMENU_2
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0242   08??               M                 MOVFW   SYMBOL_POINTER
0243   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0244   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0245   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
0246   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
0247   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
0248   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
0249   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
024A                      M         TABLE
024A   3435 342E 3432     M                                                                 DT              MENU_SUBMENU_NAME_5_2,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000003                M                                                                 A+=1
Warning[207]: Found label after column 1. (MENU_5_SUBMENU_3)
0256                      M                                                                 MENU_5_SUBMENU_3
                          M                                                                 MOD_PCL SYMBOL_POINTER
  0000                    M                 LOCAL   TABLE
0256   08??               M                 MOVFW   SYMBOL_POINTER
0257   3E??               M                 ADDLW   LOW TABLE               ; Добавить 8 младших бит адреса таблицы к смещению
0258   00??               M                 MOVWF   OFFSET                  ; Сохранить младшие 8 бит требуемого адреса
                          M         IF      USE_SHORT_MOD_PCL
0259   0D??               M                 RLF             KNOWN_ZERO,W    ; так сохраняют бит переполнения от сложения 
025A   3E??               M                 ADDLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M         ELSE
                          M                 MOVLW   HIGH TABLE              ; Загрузить 5 старших бит адреса
                          M                 BTFSC   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 ADDLW   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         ENDIF
025B   008A               M                 MOVWF   PCLATH                  ; Установить старшую часть адреса
025C   08??               M                 MOVFW   OFFSET                  ; Загрузить рассчитанное значание младшей части адреса
025D   0082               M                 MOVWF   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (TABLE)
025E                      M         TABLE
025E   3435 342E 3433     M                                                                 DT              MENU_SUBMENU_NAME_5_3,0
       342E 3453 3475 
       3462 344D 3465 
       346E 3475 3400 
Warning[207]: Found label after column 1. (A)
  00000004                M                                                                 A+=1
                          M                                                         ENDW
Warning[207]: Found label after column 1. (D)
  00000006                M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 6 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                                                 MENU_6_SUBMENU_4
                          M                                                                 MOD_PCL SYMBOL_POINTER
                          M                                                                 DT              MENU_SUBMENU_NAME_5_4,0
                          M                                                                 A+=1
                          M                                                         ENDW
                          M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 7 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                                         LOCAL   A=1     
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                                                 MENU_6_SUBMENU_4
                          M                                                                 MOD_PCL SYMBOL_POINTER
                          M                                                                 DT              MENU_SUBMENU_NAME_5_4,0
                          M                                                                 A+=1
                          M                                                         ENDW
                          M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 8 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                                 IF              D<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                                         LOCAL   A=1     
                          M                                                         WHILE   A<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                                                 MENU_6_SUBMENU_4
                          M                                                                 MOD_PCL SYMBOL_POINTER
                          M                                                                 DT              MENU_SUBMENU_NAME_5_4,0
                          M                                                                 A+=1
                          M                                                         ENDW
                          M                                                         D+=1
                          M                                                 ENDIF
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                      00051 ;===================================================================================================
Warning[205]: Found directive in column 1. (IF)
                      00052 IF      USE_MENU_ACTION
                      00053 MENU_ACTION
                      00054         GOTO_MENU_ACTION
                      00055 ;===================================================================================================
                      00056 MENU_1_ACTION                                                   ; Выполняем действие 1 пункта меню
                      00057 ;       nop
                      00058         GOTO    END_MENU_ACTION
                      00059 MENU_2_ACTION                                                   ; Выполняем действие 2 пункта меню
                      00060 ;       nop
                      00061         GOTO    END_MENU_ACTION
                      00062 MENU_3_ACTION                                                   ; Выполняем действие 3 пункта меню
                      00063 ;       nop
                      00064         GOTO    END_MENU_ACTION
                      00065 MENU_4_ACTION                                                   ; Выполняем действие 4 пункта меню
                      00066 ;       nop
                      00067         GOTO    END_MENU_ACTION
                      00068 MENU_5_ACTION                                                   ; Выполняем действие 5 пункта меню
                      00069 ;       nop
                      00070         GOTO    END_MENU_ACTION
                      00071 ENDIF
                      00072 ;===================================================================================================
026A                  00073 MENU_1_SUBMENU_1_ACTION                                 ; Выполняем действие 1 подпункта 1 пункта
                      00074 ;       nop
026A   2???           00075         GOTO    END_ACTION
026B                  00076 MENU_1_SUBMENU_2_ACTION                                 ; Выполняем действие 2 подпункта 1 пункта
                      00077 ;       nop
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

026B   2???           00078         GOTO    END_ACTION
026C                  00079 MENU_1_SUBMENU_3_ACTION                                 ; Выполняем действие 3 подпункта 1 пункта
                      00080 ;       nop
026C   2???           00081         GOTO    END_ACTION
                      00082 ;---------------------------------------------------------------------------------------------------
026D                  00083 MENU_2_SUBMENU_1_ACTION                                 ; Выполняем действие 1 подпункта 2 пункта
                      00084 ;       nop
026D   2???           00085         GOTO    END_ACTION
026E                  00086 MENU_2_SUBMENU_2_ACTION                                 ; Выполняем действие 2 подпункта 2 пункта
                      00087 ;       nop
026E   2???           00088         GOTO    END_ACTION
026F                  00089 MENU_2_SUBMENU_3_ACTION                                 ; Выполняем действие 3 подпункта 2 пункта
                      00090 ;       nop
026F   2???           00091         GOTO    END_ACTION
                      00092 ;---------------------------------------------------------------------------------------------------
0270                  00093 MENU_3_SUBMENU_1_ACTION                                 ; Выполняем действие 1 подпункта 3 пункта
                      00094 ;       nop
0270   2???           00095         GOTO    END_ACTION
0271                  00096 MENU_3_SUBMENU_2_ACTION                                 ; Выполняем действие 2 подпункта 3 пункта
                      00097 ;       nop
0271   2???           00098         GOTO    END_ACTION
0272                  00099 MENU_3_SUBMENU_3_ACTION                                 ; Выполняем действие 3 подпункта 3 пункта
                      00100 ;       nop
0272   2???           00101         GOTO    END_ACTION
                      00102 ;---------------------------------------------------------------------------------------------------
0273                  00103 MENU_4_SUBMENU_1_ACTION                                 ; Выполняем действие 1 подпункта 4 пункта
                      00104 ;       nop
0273   2???           00105         GOTO    END_ACTION
0274                  00106 MENU_4_SUBMENU_2_ACTION                                 ; Выполняем действие 2 подпункта 4 пункта
                      00107 ;       nop
0274   2???           00108         GOTO    END_ACTION
0275                  00109 MENU_4_SUBMENU_3_ACTION                                 ; Выполняем действие 3 подпункта 4 пункта
                      00110 ;       nop
0275   2???           00111         GOTO    END_ACTION                                                              
                      00112 ;---------------------------------------------------------------------------------------------------
0276                  00113 MENU_5_SUBMENU_1_ACTION                                 ; Выполняем действие 1 подпункта 5 пункта
                      00114 ;       nop
0276   2???           00115         GOTO    END_ACTION
0277                  00116 MENU_5_SUBMENU_2_ACTION                                 ; Выполняем действие 2 подпункта 5 пункта
                      00117 ;       nop
0277   2???           00118         GOTO    END_ACTION
0278                  00119 MENU_5_SUBMENU_3_ACTION                                 ; Выполняем действие 3 подпункта 5 пункта
                      00120 ;       nop
0278   2???           00121         GOTO    END_ACTION                      
                      00122 ;===================================================================================================
0279                  00123 CLR_DISPLAY_ROUTINE                                             ; Подпрограмма очистки дисплея
0279   3001           00124         MOVLW   CLR_DISP
027A   2???           00125         CALL    SEND_LCD_COMMAND
027B   2???           00126         CALL    DELAY_4MS                                       ; Обязательная задержка после очистки ди
                            сплея !!!
027C   0008           00127         RETURN
                      00128 ;===================================================================================================
027D                  00129 SECOND_STRING_ROUTINE                                   ; Подпрограмма перевода указателя на 2-ю строку 
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (IF)
                      00130 IF      USE_STATIC_CURSOR
                      00131         MOVLW   B'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки
                      00132         CALL    SEND_LCD_COMMAND
                      00133         MOVLW   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
                      00134         CALL    SEND_LCD_SYMBOL
                      00135 ENDIF
027D   30C0           00136         MOVLW   SECOND_LINE                                     ; Переводим указатель на 2-ю строку     
027E   2???           00137         CALL    SEND_LCD_COMMAND
027F   0008           00138         RETURN                                                          ; И приступаем к отрисовке следу
                            ющего пункта меню
                      00139 ;===================================================================================================
0280                  00140 SWITCH_MENU_ROUTINE                                             ; Подпрограмма вывода названия пункта ме
                            ню на дисплей
0280   01??           00141         CLRF    SYMBOL_POINTER
0281                  00142 STRING_MENU
0281   2???           00143         CALL    SWITCH_MENU_TABLE
0282   39FF           00144         ANDLW   0FFH
0283   1903           00145         BTFSC   STATUS,Z
0284   0008           00146         RETURN 
0285   2???           00147         CALL    SEND_LCD_SYMBOL
Message[305]: Using default destination of 1 (file).
0286   0A??           00148         INCF    SYMBOL_POINTER  
0287   2???           00149         GOTO    STRING_MENU
                      00150 ;-------------------------------------------------------------------------------------------------------
                            ---------------------
0288                  00151 SWITCH_SUBMENU_ROUTINE                                  ; Подпрограмма вывода названия подпункта меню на
                             дисплей
0288   01??           00152         CLRF    SYMBOL_POINTER
0289                  00153 STRING_SUBMENU
0289   2???           00154         CALL    SWITCH_SUBMENU_TABLE
028A   39FF           00155         ANDLW   0FFH
028B   1903           00156         BTFSC   STATUS,Z
028C   0008           00157         RETURN 
028D   2???           00158         CALL    SEND_LCD_SYMBOL
Message[305]: Using default destination of 1 (file).
028E   0A??           00159         INCF    SYMBOL_POINTER  
028F   2???           00160         GOTO    STRING_SUBMENU
                      00161 ;===================================================================================================
0290                  00162 MENU_HEANDLER                                                   ; Обработчик меню
0290   01??           00163         CLRF    INDEX_MENU                                      ; Была нажатая какая-то кнопка, очистим 
                            индекс пункта меню                                      
                      00164 
Warning[205]: Found directive in column 1. (IF)
                      00165 IF      USE_MOVING_CURSOR       &       !USE_TOP_LAST_CURSOR
                      00166         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00167         ANDWF   FLAGS                                           
                      00168         BSF             PRESS_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
                      00169 ENDIF
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00170 
0291                  00171 SWITCH_MENU                                                             ; Поместим курсор на нужный пунк
                            т меню                                                  
                      00172 
Warning[205]: Found directive in column 1. (IF)
                      00173 IF      USE_MOVING_CURSOR       &       USE_TOP_LAST_CURSOR
0291   08??           00174         MOVFW   INDEX_MENU
0292   1D03           00175         BTFSS   STATUS,Z
0293   2???           00176         GOTO    CHECK_1         
0294   30F0           00177         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
0295   05??           00178         ANDWF   FLAGS   
0296   1400           00179         BSF             PRESS_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
0297   2???           00180         GOTO    SKIP_CHECK_1
0298                  00181 CHECK_1
0298   3C04           00182         SUBLW   NUM_OF_MAIN_MENU_PUNKTS-1       ; Сравниваем с количеством пунктов меню
0299   1D03           00183         BTFSS   STATUS,Z        
029A   2???           00184         GOTO    SKIP_CHECK_1    
029B   30F0           00185         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
029C   05??           00186         ANDWF   FLAGS
029D   1480           00187         BSF             PRESS_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
029E                  00188 SKIP_CHECK_1
Warning[205]: Found directive in column 1. (ENDIF)
                      00189 ENDIF
                      00190 
029E   2???           00191         CALL    CLR_DISPLAY_ROUTINE                     ; Очистим дисплей перед самой перерисовкой пункт
                            ов меню, чтобы уменьшить моргание
                      00192 
Warning[205]: Found directive in column 1. (IF)
                      00193 IF      USE_MOVING_CURSOR
029F   1C00           00194         BTFSS   PRESS_UP
02A0   2???           00195         GOTO    PRESSING_DOWN                   
02A1   2???           00196         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем текущий пункт меню     
02A2   308F           00197         MOVLW   B'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки       
02A3   2???           00198         CALL    SEND_LCD_COMMAND
02A4   303C           00199         MOVLW   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
02A5   2???           00200         CALL    SEND_LCD_SYMBOL
02A6   2???           00201         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
02A7   0A??           00202         INCF    INDEX_MENU                                      ; Берем следующий пункт
02A8   08??           00203         MOVFW   INDEX_MENU      
02A9   3C05           00204         SUBLW   NUM_OF_MAIN_MENU_PUNKTS         ; Сравниваем с количеством пунктов меню
02AA   1903           00205         BTFSC   STATUS,Z
02AB   2???           00206         GOTO    CORRECT_INDEX_MENU                      
02AC   2???           00207         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем пункт меню под текущим 
Message[305]: Using default destination of 1 (file).
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02AD   03??           00208         DECF    INDEX_MENU                                      ; Не забудем вернуть назад текущий пункт
                             меню   
02AE   2???           00209         GOTO    SKIP_CORRECT_INDEX_MENU_3
02AF                  00210 CORRECT_INDEX_MENU                                              ; Достигли последнего пункта меню, следу
                            ющим отображаем 1 пункт
02AF   01??           00211         CLRF    INDEX_MENU
02B0   2???           00212         CALL    SWITCH_MENU_ROUTINE
02B1   3004           00213         MOVLW   NUM_OF_MAIN_MENU_PUNKTS-1
02B2   00??           00214         MOVWF   INDEX_MENU      
02B3   2???           00215         GOTO    SKIP_CORRECT_INDEX_MENU_3
                      00216 
02B4                  00217 PRESSING_DOWN
Message[305]: Using default destination of 1 (file).
02B4   03??           00218         DECF    INDEX_MENU                                      ; Берем предыдущий пункт меню
02B5   1B80           00219         BTFSC   INDEX_MENU,.7                           ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
02B6   2???           00220         GOTO    CORRECT_INDEX_MENU_2
02B7   2???           00221         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем предыдущий пункт меню
02B8   2???           00222         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
02B9   0A??           00223         INCF    INDEX_MENU                                      ; Вернем текущий пункт                  
                                            
02BA   08??           00224         MOVFW   INDEX_MENU      
02BB   2???           00225         GOTO    SKIP_CORRECT_INDEX_MENU_2
02BC                  00226 CORRECT_INDEX_MENU_2
02BC   3004           00227         MOVLW   NUM_OF_MAIN_MENU_PUNKTS-1
02BD   00??           00228         MOVWF   INDEX_MENU
02BE   2???           00229         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем предыдущий пункт меню
02BF   2???           00230         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
02C0   01??           00231         CLRF    INDEX_MENU
02C1                  00232 SKIP_CORRECT_INDEX_MENU_2
02C1   2???           00233         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем текущий пункт меню под предыдущим 
02C2   30CF           00234         MOVLW   B'11001111'                                     ; Установим курсор на последний символ 2
                            -й строки
02C3   2???           00235         CALL    SEND_LCD_COMMAND
02C4   303C           00236         MOVLW   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
02C5   2???           00237         CALL    SEND_LCD_SYMBOL
02C6                  00238 SKIP_CORRECT_INDEX_MENU_3
                      00239 
Warning[205]: Found directive in column 1. (ELSE)
                      00240 ELSE
                      00241         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем текущий пункт меню
                      00242         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
                      00243         INCF    INDEX_MENU                                      ; Берем следующий пункт
                      00244         MOVFW   INDEX_MENU      
                      00245         SUBLW   NUM_OF_MAIN_MENU_PUNKTS         ; Сравниваем с количеством пунктов меню
                      00246         BTFSC   STATUS,Z
                      00247         GOTO    CORRECT_INDEX_MENU                      
                      00248         CALL    SWITCH_MENU_ROUTINE                     ; Рисуем пункт меню под текущим 
                      00249         DECF    INDEX_MENU                                      ; Не забудем вернуть назад текущий пункт
                             меню   
                      00250         GOTO    SKIP_CORRECT_INDEX_MENU
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00251 CORRECT_INDEX_MENU                                              ; Достигли последнего пункта меню, следу
                            ющим отображаем 1 пункт
                      00252         CLRF    INDEX_MENU
                      00253         CALL    SWITCH_MENU_ROUTINE
                      00254         MOVLW   NUM_OF_MAIN_MENU_PUNKTS-1
                      00255         MOVWF   INDEX_MENU      
                      00256 SKIP_CORRECT_INDEX_MENU
                      00257 ENDIF
                      00258 
02C6   2???           00259         CALL    DEBOUNCE_DELAY                          ; Процедура антидребезга, вызывается при первом 
                            входе в меню, при нажатии кнопок "Вверх", "Вниз", выходе из подпункта меню
                      00260 
Warning[205]: Found directive in column 1. (IF)
                      00261 IF      USE_RBIE
02C7   30F0           00262         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02C8   05??           00263         ANDWF   FLAGS   
02C9   100B           00264         BCF             INTCON,RBIF                                     ; Сбросим флаг возможно вызваног
                            о прерывания от кнопок
02CA   158B           00265         BSF             INTCON,RBIE                                     ; И разрешим прерывания от кнопо
                            к
Warning[205]: Found directive in column 1. (ENDIF)
                      00266 ENDIF
                      00267 
02CB   3014           00268         MOVLW   EXIT_DELAY                                      ; Заносим счетчик проходов опроса клавиш
02CC   00??           00269         MOVWF   MENU_COUNTER
02CD   01??           00270         CLRF    TEMP_1
02CE   01??           00271         CLRF    TEMP_2
02CF                  00272 LOOP_MENU                                                               ; Вычисляем нажатую клавишу
                      00273 
Warning[205]: Found directive in column 1. (IF)
                      00274 IF      USE_RBIE
02CF   1800           00275         BTFSC   PRESS_UP
02D0   2???           00276         GOTO    CURSOR_UP_MENU                          
02D1   1880           00277         BTFSC   PRESS_DOWN
02D2   2???           00278         GOTO    CURSOR_DOWN_MENU
02D3   1980           00279         BTFSC   PRESS_ENTER
02D4   2???           00280         GOTO    ENTER_MENU
02D5   1900           00281         BTFSC   PRESS_EXIT
02D6   2???           00282         GOTO    EXIT_MENU
Warning[205]: Found directive in column 1. (ELSE)
                      00283 ELSE
                      00284         BTFSS   UP
                      00285         GOTO    CURSOR_UP_MENU                          
                      00286         BTFSS   DOWN
                      00287         GOTO    CURSOR_DOWN_MENU
                      00288         BTFSS   ENTER
                      00289         GOTO    ENTER_MENU
                      00290         BTFSS   EXIT
                      00291         GOTO    EXIT_MENU
                      00292 ENDIF
                      00293 ;-----------------------------------------------------------------                                      
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                                                                    
Message[305]: Using default destination of 1 (file).
02D7   0B??           00294         DECFSZ  TEMP_1                                          ; Ни одна клавиша не нажата             
                                                            
02D8   2???           00295         GOTO    LOOP_MENU                                       ; Цикл ожидания нажатия в главном меню  
Message[305]: Using default destination of 1 (file).
02D9   0B??           00296         DECFSZ  TEMP_2  
02DA   2???           00297         GOTO    LOOP_MENU
Message[305]: Using default destination of 1 (file).
02DB   0B??           00298         DECFSZ  MENU_COUNTER                            ; Декремент счетчика проходов опроса клавиш     
02DC   2???           00299         GOTO    LOOP_MENU
02DD   2???           00300         GOTO    ZASTAVKA                                        ; Вышел таймаут нахождения в меню, выход
                            им в заставку   
                      00301 ;-----------------------------------------------------------------
02DE                  00302 CURSOR_UP_MENU                                                  ; Была нажата клавиша "Вверх"
                      00303 
Warning[205]: Found directive in column 1. (IF)
                      00304 IF      USE_MOVING_CURSOR       &       !USE_RBIE
                      00305         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00306         ANDWF   FLAGS                                           
                      00307         BSF             PRESS_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
                      00308 ENDIF
                      00309 
Message[305]: Using default destination of 1 (file).
02DE   03??           00310         DECF    INDEX_MENU                                      ; Берем предыдущий пункт меню
02DF   1F80           00311         BTFSS   INDEX_MENU,.7                           ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
02E0   2???           00312         GOTO    SWITCH_MENU
02E1   3004           00313         MOVLW   NUM_OF_MAIN_MENU_PUNKTS-1       ; Стало "<0", сделаем текущим последний пункт меню. Учит
                            ываем, что индекс пункта меню на 1 меньше его порядкового номера
02E2   00??           00314         MOVWF   INDEX_MENU
02E3   2???           00315         GOTO    SWITCH_MENU                                     ; Отрисовываем новый текущий пункт меню
                      00316 ;-----------------------------------------------------------------
02E4                  00317 CURSOR_DOWN_MENU                                                ; Была нажата клавиша "Вниз"
                      00318 
Warning[205]: Found directive in column 1. (IF)
                      00319 IF      USE_MOVING_CURSOR       &       !USE_RBIE
                      00320         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00321         ANDWF   FLAGS                                           
                      00322         BSF             PRESS_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
                      00323 ENDIF
                      00324 
Message[305]: Using default destination of 1 (file).
02E4   0A??           00325         INCF    INDEX_MENU                                      ; Берем следущий пункт меню
02E5   08??           00326         MOVFW   INDEX_MENU
02E6   3C05           00327         SUBLW   NUM_OF_MAIN_MENU_PUNKTS         ; Достигли последнего ?
02E7   1903           00328         BTFSC   STATUS,Z
02E8   01??           00329         CLRF    INDEX_MENU                                      ; Если да, делаем текущим первый пункт м
                            еню     
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02E9   2???           00330         GOTO    SWITCH_MENU                                     ; Отрисовываем новый текущий пункт меню
                      00331 ;-----------------------------------------------------------------
02EA                  00332 EXIT_MENU                                                               ; Была нажата клавиша "Выход"
                      00333 
Warning[205]: Found directive in column 1. (IF)
                      00334 IF      USE_RBIE
02EA   30F0           00335         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02EB   05??           00336         ANDWF   FLAGS   
02EC   100B           00337         BCF             INTCON,RBIF                                     ; Сбросим флаг возможно вызваног
                            о прерывания
02ED   158B           00338         BSF             INTCON,RBIE                                     ; И разрешим прерывания от кнопо
                            к
Warning[205]: Found directive in column 1. (ELSE)
                      00339 ELSE
                      00340         CALL    DEBOUNCE_DELAY  
                      00341 ENDIF
02EE   2???           00342         GOTO    ZASTAVKA                                        ; Выходим в заставку
                      00343 ;-----------------------------------------------------------------
02EF                  00344 ENTER_MENU                                                              ; Была нажата клавиша "Вход"
                      00345 
Warning[205]: Found directive in column 1. (IF)
                      00346 IF      USE_MENU_ACTION         
                      00347         MOVFW   INDEX_MENU                                      ; Берем текущий пункт меню
                      00348         MOVWF   TEMP_1                                          ; Заносим в счетчик
                      00349         INCF    TEMP_1                                          ; Учитываем, что нумерация начинается с 
                            0
                      00350         MOVLW   ACTIONS_MENU_FLAGS                      ; Берем флаги действий пунктов меню
                      00351         MOVWF   TEMP_2                                          ; И заносим в переменную
                      00352 LOOP_1
                      00353         DECFSZ  TEMP_1
                      00354         GOTO    ROTATE_ACTION_MENU_FLAGS
                      00355         BTFSC   STATUS,C                                        ; Флаг действия текущего пункта меню выд
                            авлен в бит переноса, анализируем его
                      00356         GOTO    MENU_ACTION                                     ; У текущего пункта меню есть действие, 
                            выполняем его
                      00357         GOTO    END_MENU_ACTION
                      00358 ROTATE_ACTION_MENU_FLAGS
                      00359         RRF             TEMP_2                                          ; Перебор флагов действий всех п
                            унктов меню
                      00360         GOTO    LOOP_1  
                      00361 END_MENU_ACTION
                      00362 ENDIF
                      00363 
02EF   01??           00364         CLRF    INDEX_SUBMENU                           ; Очистим индекс пункта подменю 
                      00365 
Warning[205]: Found directive in column 1. (IF)
                      00366 IF      USE_MOVING_CURSOR       &       !USE_TOP_LAST_CURSOR
                      00367         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00368         ANDWF   FLAGS                                           
                      00369         BSF             PRESS_UP                                        ; И установим признак нажатия то
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            лько для кнопки "ВВЕРХ"
                      00370 ENDIF
                      00371 
02F0                  00372 SWITCH_SUBMENU                                                  ; Поместим курсор на нужный подпункт нуж
                            ного пункта
                      00373 
Warning[205]: Found directive in column 1. (IF)
                      00374 IF      USE_MOVING_CURSOR       &       USE_TOP_LAST_CURSOR
02F0   08??           00375         MOVFW   INDEX_SUBMENU
02F1   1D03           00376         BTFSS   STATUS,Z
02F2   2???           00377         GOTO    CHECK_2         
02F3   30F0           00378         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02F4   05??           00379         ANDWF   FLAGS   
02F5   1400           00380         BSF             PRESS_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
02F6   2???           00381         GOTO    SKIP_CHECK_2
02F7                  00382 CHECK_2
02F7   2???           00383         CALL    NUM_OF_SUBMENU_TABLE                    
02F8   00??           00384         MOVWF   TEMP_1  
02F9   03??           00385         DECF    TEMP_1, W                                       ; Учитываем, что индекс подпункта начина
                            ется с 0
02FA   02??           00386         SUBWF   INDEX_SUBMENU,W                         ; Сравниваем с количеством подпунктов меню
02FB   1D03           00387         BTFSS   STATUS,Z        
02FC   2???           00388         GOTO    SKIP_CHECK_2    
02FD   30F0           00389         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02FE   05??           00390         ANDWF   FLAGS
02FF   1480           00391         BSF             PRESS_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
0300                  00392 SKIP_CHECK_2
Warning[205]: Found directive in column 1. (ENDIF)
                      00393 ENDIF
                      00394 
0300   2???           00395         CALL    CLR_DISPLAY_ROUTINE                     ; Очистим дисплей перед самой перерисовкой подпу
                            нктов меню, чтобы уменьшить моргание
                      00396 
Warning[205]: Found directive in column 1. (IF)
                      00397 IF      USE_MOVING_CURSOR
0301   1C00           00398         BTFSS   PRESS_UP
0302   2???           00399         GOTO    PRESSING_DOWN_2                 
0303   2???           00400         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем текущий подпункт меню  
0304   308F           00401         MOVLW   B'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки       
0305   2???           00402         CALL    SEND_LCD_COMMAND
0306   303C           00403         MOVLW   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
0307   2???           00404         CALL    SEND_LCD_SYMBOL
0308   2???           00405         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
0309   0A??           00406         INCF    INDEX_SUBMENU                           ; Берем следующий пункт
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

030A   2???           00407         CALL    NUM_OF_SUBMENU_TABLE                    
030B   02??           00408         SUBWF   INDEX_SUBMENU,W                         ; Сравниваем с количеством подпунктов меню
030C   1903           00409         BTFSC   STATUS,Z
030D   2???           00410         GOTO    CORRECT_INDEX_SUBMENU                   
030E   2???           00411         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем подпункт меню под текущим 
Message[305]: Using default destination of 1 (file).
030F   03??           00412         DECF    INDEX_SUBMENU                           ; Не забудем вернуть назад текущий пункт меню   
0310   2???           00413         GOTO    SKIP_CORRECT_INDEX_SUBMENU_3
0311                  00414 CORRECT_INDEX_SUBMENU                                   ; Достигли последнего подпункта меню, следующим 
                            отображаем 1 подпункт
0311   01??           00415         CLRF    INDEX_SUBMENU
0312   2???           00416         CALL    SWITCH_SUBMENU_ROUTINE
0313   2???           00417         CALL    NUM_OF_SUBMENU_TABLE
0314   00??           00418         MOVWF   INDEX_SUBMENU
Message[305]: Using default destination of 1 (file).
0315   03??           00419         DECF    INDEX_SUBMENU                           ; Учитываем, что индекс подпункта начинается с 0
                                    
0316   2???           00420         GOTO    SKIP_CORRECT_INDEX_SUBMENU_3
                      00421 
0317                  00422 PRESSING_DOWN_2
Message[305]: Using default destination of 1 (file).
0317   03??           00423         DECF    INDEX_SUBMENU                           ; Берем предыдущий пункт меню
0318   1B80           00424         BTFSC   INDEX_SUBMENU,.7                        ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
0319   2???           00425         GOTO    CORRECT_INDEX_SUBMENU_2
031A   2???           00426         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем предыдущий пункт меню
031B   2???           00427         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
031C   0A??           00428         INCF    INDEX_SUBMENU                           ; Вернем текущий пункт                          
                                    
031D   08??           00429         MOVFW   INDEX_SUBMENU   
031E   2???           00430         GOTO    SKIP_CORRECT_INDEX_SUBMENU_2
031F                  00431 CORRECT_INDEX_SUBMENU_2
031F   2???           00432         CALL    NUM_OF_SUBMENU_TABLE            ; Стало "<0", возвращаем количество пунктов в даном подм
                            еню     
0320   00??           00433         MOVWF   INDEX_SUBMENU                           ; Сделаем текущим последний пункт подменю
Message[305]: Using default destination of 1 (file).
0321   03??           00434         DECF    INDEX_SUBMENU                           ; Учитываем, что индекс пункта подменю на 1 мень
                            ше его порядкового номера
0322   2???           00435         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем предыдущий пункт меню
0323   2???           00436         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
0324   01??           00437         CLRF    INDEX_SUBMENU
0325                  00438 SKIP_CORRECT_INDEX_SUBMENU_2
0325   2???           00439         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем текущий пункт меню под предыдущим 
0326   30CF           00440         MOVLW   B'11001111'                                     ; Установим курсор на последний символ 2
                            -й строки
0327   2???           00441         CALL    SEND_LCD_COMMAND
0328   303C           00442         MOVLW   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
0329   2???           00443         CALL    SEND_LCD_SYMBOL
032A                  00444 SKIP_CORRECT_INDEX_SUBMENU_3
                      00445 
Warning[205]: Found directive in column 1. (ELSE)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00446 ELSE
                      00447         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем текущий подпункт меню  
                      00448         CALL    SECOND_STRING_ROUTINE           ; Указатель на 2 строку
                      00449         INCF    INDEX_SUBMENU
                      00450         CALL    NUM_OF_SUBMENU_TABLE                    
                      00451         SUBWF   INDEX_SUBMENU,W                         ; Сравниваем с количеством подпунктов меню
                      00452         BTFSC   STATUS,Z
                      00453         GOTO    CORRECT_INDEX_SUBMENU
                      00454         CALL    SWITCH_SUBMENU_ROUTINE          ; Рисуем подпункт меню под текущим 
                      00455         DECF    INDEX_SUBMENU                           ; Не забудем вернуть назад текущий подпункт меню
                      00456         GOTO    SKIP_CORRECT_INDEX_SUBMENU      
                      00457 CORRECT_INDEX_SUBMENU                                   ; Достигли последнего подпункта меню, следующим 
                            отображаем 1 подпункт
                      00458         CLRF    INDEX_SUBMENU   
                      00459         CALL    SWITCH_SUBMENU_ROUTINE
                      00460         CALL    NUM_OF_SUBMENU_TABLE
                      00461         MOVWF   INDEX_SUBMENU   
                      00462         DECF    INDEX_SUBMENU                           ; Учитываем, что индекс подпункта начинается с 0
                      00463 SKIP_CORRECT_INDEX_SUBMENU
                      00464 ENDIF
                      00465 
032A   2???           00466         CALL    DEBOUNCE_DELAY                          ; Процедура антидребезга, вызывается при первом 
                            входе в подпункт меню, при нажатии кнопок "Вверх", "Вниз", выходе из действия подпункта меню
                      00467 
Warning[205]: Found directive in column 1. (IF)
                      00468 IF      USE_RBIE
032B   30F0           00469         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
032C   05??           00470         ANDWF   FLAGS   
032D   100B           00471         BCF             INTCON,RBIF                                     ; Сбросим флаг возможно вызваног
                            о прерывания
032E   158B           00472         BSF             INTCON,RBIE                                     ; И разрешим прерывания от кнопо
                            к
Warning[205]: Found directive in column 1. (ENDIF)
                      00473 ENDIF
                      00474 
032F   3014           00475         MOVLW   EXIT_DELAY                                      ; Заносим счетчик проходов опроса клавиш
0330   00??           00476         MOVWF   MENU_COUNTER
0331   01??           00477         CLRF    TEMP_1
0332   01??           00478         CLRF    TEMP_2
0333                  00479 LOOP_SUBMENU                                                    ; Мы зашли в пункт меню, ждем нажатия сл
                            едующей кнопки
                      00480 
Warning[205]: Found directive in column 1. (IF)
                      00481 IF      USE_RBIE
0333   1800           00482         BTFSC   PRESS_UP
0334   2???           00483         GOTO    CURSOR_UP_SUBMENU                               
0335   1880           00484         BTFSC   PRESS_DOWN
0336   2???           00485         GOTO    CURSOR_DOWN_SUBMENU
0337   1980           00486         BTFSC   PRESS_ENTER
0338   2???           00487         GOTO    ENTER_SUBMENU
0339   1900           00488         BTFSC   PRESS_EXIT
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

033A   2???           00489         GOTO    EXIT_SUBMENU
Warning[205]: Found directive in column 1. (ELSE)
                      00490 ELSE
                      00491         BTFSS   UP
                      00492         GOTO    CURSOR_UP_SUBMENU                               
                      00493         BTFSS   DOWN
                      00494         GOTO    CURSOR_DOWN_SUBMENU
                      00495         BTFSS   ENTER
                      00496         GOTO    ENTER_SUBMENU
                      00497         BTFSS   EXIT
                      00498         GOTO    EXIT_SUBMENU
                      00499 ENDIF
                      00500 ;-----------------------------------------------------------------
Message[305]: Using default destination of 1 (file).
033B   0B??           00501         DECFSZ  TEMP_1                                          ; Ни одна клавиша не нажата     
033C   2???           00502         GOTO    LOOP_SUBMENU                            ; Цикл ожидания нажатия в пункте меню
Message[305]: Using default destination of 1 (file).
033D   0B??           00503         DECFSZ  TEMP_2  
033E   2???           00504         GOTO    LOOP_SUBMENU
Message[305]: Using default destination of 1 (file).
033F   0B??           00505         DECFSZ  MENU_COUNTER                            ; Декремент счетчика проходов опроса клавиш     
                                    
0340   2???           00506         GOTO    LOOP_SUBMENU
0341   2???           00507         GOTO    SWITCH_MENU                                     ; Вышел таймаут нахождения в подменю, вы
                            ходим в предыдущий пункт меню
                      00508 ;-----------------------------------------------------------------
0342                  00509 CURSOR_UP_SUBMENU                                               ; Была нажата клавиша "Вверх"
                      00510 
Warning[205]: Found directive in column 1. (IF)
                      00511 IF      USE_MOVING_CURSOR       &       !USE_RBIE
                      00512         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00513         ANDWF   FLAGS                                           
                      00514         BSF             PRESS_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
                      00515 ENDIF
                      00516 
Message[305]: Using default destination of 1 (file).
0342   03??           00517         DECF    INDEX_SUBMENU                           ; Берем предыдущий пункт подменю
0343   1F80           00518         BTFSS   INDEX_SUBMENU,.7                        ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество подпунктов меню ограничено 64
0344   2???           00519         GOTO    SWITCH_SUBMENU  
0345   2???           00520         CALL    NUM_OF_SUBMENU_TABLE            ; Стало "<0", возвращаем количество пунктов в даном подм
                            еню     
0346   00??           00521         MOVWF   INDEX_SUBMENU                           ; Сделаем текущим последний пункт подменю
Message[305]: Using default destination of 1 (file).
0347   03??           00522         DECF    INDEX_SUBMENU                           ; Учитываем, что индекс пункта подменю на 1 мень
                            ше его порядкового номера
0348   2???           00523         GOTO    SWITCH_SUBMENU                          ; Отрисовываем новый текущий подпункт меню      
                      00524 ;-----------------------------------------------------------------
0349                  00525 CURSOR_DOWN_SUBMENU                                             ; Была нажата клавиша "Вниз"
                      00526 
Warning[205]: Found directive in column 1. (IF)
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00527 IF      USE_MOVING_CURSOR       &       !USE_RBIE
                      00528         MOVLW   B'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00529         ANDWF   FLAGS                                           
                      00530         BSF             PRESS_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
                      00531 ENDIF
                      00532 
Message[305]: Using default destination of 1 (file).
0349   0A??           00533         INCF    INDEX_SUBMENU                           ; Берем следущий пункт подменю
034A   2???           00534         CALL    NUM_OF_SUBMENU_TABLE            ; Возвращаем количество пунктов в даном подменю 
034B   02??           00535         SUBWF   INDEX_SUBMENU,W                         ; Достигли последнего ? 
034C   1903           00536         BTFSC   STATUS,Z
034D   01??           00537         CLRF    INDEX_SUBMENU                           ; Если да, делаем текущим первый подпункт меню  
                                    
034E   2???           00538         GOTO    SWITCH_SUBMENU                          ; Отрисовываем новый текущий подпункт меню
                      00539 ;-----------------------------------------------------------------      
034F                  00540 EXIT_SUBMENU                                                    ; Была нажата клавиша "Выход"
034F   01??           00541         CLRF    INDEX_SUBMENU                           ; Обнуляем индекс пункта подменю, чтобы при след
                            ующем заходе в любой пункт меню курсор находился на 1 пункте подменю                    
0350   2???           00542         GOTO    SWITCH_MENU                                     ; Выходим в меню
                      00543 ;-----------------------------------------------------------------
0351                  00544 ENTER_SUBMENU                                                   ; Была нажата клавиша "Вход"
0351   2???           00545         CALL    CLR_DISPLAY_ROUTINE                     ; Очистим дисплей
0352   2???           00546         GOTO    SWITCH_ACTION                           ; Делаем действие текущего подпункта меню
0353                  00547 END_ACTION
                      00548 ;-----------------------------------------------------------------
0353   01??           00549         CLRF    SYMBOL_POINTER                          ; Рисуем подтверждение действия
0354                  00550 STRING_ACTION_COMPLETE
0354   2???           00551         CALL    TABLE_ACTION_COMPLETE   
0355   39FF           00552         ANDLW   0FFH
0356   1903           00553         BTFSC   STATUS,Z
0357   2???           00554         GOTO    OUT_ACTION_COMPLETE
0358   2???           00555         CALL    SEND_LCD_SYMBOL
Message[305]: Using default destination of 1 (file).
0359   0A??           00556         INCF    SYMBOL_POINTER  
035A   2???           00557         GOTO    STRING_ACTION_COMPLETE
035B                  00558 OUT_ACTION_COMPLETE
035B   01??           00559         CLRF    TEMP_3                                          ; Задержка, чтобы успеть прочесть уведом
                            ление о выполнении действи
035C   2???           00560         CALL    DEBOUNCE_DELAY
Message[305]: Using default destination of 1 (file).
035D   0B??           00561         DECFSZ  TEMP_3
035E   2???           00562         GOTO    $-2
                      00563 ;-----------------------------------------------------------------
035F   2???           00564         GOTO    SWITCH_SUBMENU                          ; И идем отрисовывать подпункт меню, курсор на т
                            ом же подпункте, что и был
                      00565 ;===================================================================================================
0360                  00566 ZASTAVKA
0360   2???           00567         CALL    CLR_DISPLAY_ROUTINE                     ; Очистим дисплей
0361   01??           00568         CLRF    SYMBOL_POINTER
0362                  00569 FIRST_STRING
0362   2???           00570         CALL    TABLE_ZASTAVKA_FIRST_STRING     
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0363   39FF           00571         ANDLW   0FFH
0364   1903           00572         BTFSC   STATUS,Z
0365   2???           00573         GOTO    OUT_FIRST_STRING
0366   2???           00574         CALL    SEND_LCD_SYMBOL
Message[305]: Using default destination of 1 (file).
0367   0A??           00575         INCF    SYMBOL_POINTER  
0368   2???           00576         GOTO    FIRST_STRING
0369                  00577 OUT_FIRST_STRING
0369   30C0           00578         MOVLW   SECOND_LINE     
036A   2???           00579         CALL    SEND_LCD_COMMAND
036B   01??           00580         CLRF    SYMBOL_POINTER
036C                  00581 NEXT_STRING
036C   2???           00582         CALL    TABLE_ZASTAVKA_SECOND_STRING
036D   39FF           00583         ANDLW   0FFH
036E   1903           00584         BTFSC   STATUS,Z
036F   2???           00585         GOTO    OUT_NEXT_STRING
0370   2???           00586         CALL    SEND_LCD_SYMBOL
Message[305]: Using default destination of 1 (file).
0371   0A??           00587         INCF    SYMBOL_POINTER  
0372   2???           00588         GOTO    NEXT_STRING
0373                  00589 OUT_NEXT_STRING
0373   2???           00590         GOTO    MAIN    
                      00591 ;===================================================================================================
0374                  00592 DEBOUNCE_DELAY                                                  ; Подпрограмма антидребезговой задержки
0374   3003           00593         MOVLW   .3                                                      ; Количество проходов подбираетс
                            я экспериментальным путем
0375   00??           00594         MOVWF   TEMP_2
0376   01??           00595         CLRF    TEMP_1
0377                  00596 LOOP_DELAY
0377   0806           00597         MOVFW   PORTB                                           
0378   380F           00598         IORLW   B'00001111'                                     ; Установим незначущие разряды
0379   3E01           00599         ADDLW   .1
037A   1D03           00600         BTFSS   STATUS,Z
037B   2???           00601         GOTO    LOOP_DELAY                                      ; Если хоть одна кнопка нажата, просто з
                            ациклимся
Message[305]: Using default destination of 1 (file).
037C   0B??           00602         DECFSZ  TEMP_1  
037D   2???           00603         GOTO    $-1
Message[305]: Using default destination of 1 (file).
037E   0B??           00604         DECFSZ  TEMP_2  
037F   2???           00605         GOTO    LOOP_DELAY
0380   0008           00606         RETURN
                      00607 ;===================================================================================================
                      00608         END
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 47


SYMBOL TABLE
  LABEL                             VALUE 

ACTION_COMPLETE_STRING            "Action Complete!"
ADD_PCL                           
C                                 00000000
CHECK_1                           00000298
CHECK_2                           000002F7
CLR_DISP                          00000001
CLR_DISPLAY_ROUTINE               00000279
CNTL_TRIS_MASK                    000000F5
CORRECT_INDEX_MENU                000002AF
CORRECT_INDEX_MENU_2              000002BC
CORRECT_INDEX_SUBMENU             00000311
CORRECT_INDEX_SUBMENU_2           0000031F
CREATE_MENU_NAMES                 
CREATE_SUBMENU_NAMES              
CURSOR_DOWN_MENU                  000002E4
CURSOR_DOWN_SUBMENU               00000349
CURSOR_UP_MENU                    000002DE
CURSOR_UP_SUBMENU                 00000342
DC                                00000001
DD_RAM_ADDR                       00000080
DD_RAM_UL                         00000080
DEBOUNCE_DELAY                    00000374
DELAY_4MS                         00000000
DISP_OFF                          00000008
DISP_ON                           0000000C
DISP_ON_B                         0000000F
DISP_ON_C                         0000000E
DOWN                              PORTB,5
E                                 00000001
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
END_ACTION                        00000353
ENTER                             PORTB,6
ENTER_MENU                        000002EF
ENTER_SUBMENU                     00000351
ENTRY_DEC                         00000004
ENTRY_DEC_S                       00000005
ENTRY_INC                         00000006
ENTRY_INC_S                       00000007
EXIT                              PORTB,7
EXIT_DELAY                        .20
EXIT_MENU                         000002EA
EXIT_SUBMENU                      0000034F
F                                 00000001
FIRST_STRING                      00000362
FLAGS                             00000000
FSR                               00000004
GIE                               00000007
GOTO_PUNKT_MENU                   
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 48


SYMBOL TABLE
  LABEL                             VALUE 

GOTO_PUNKT_SUBMENU                
GOTO_PUNKT_SUBMENU_ACTION         
INDEX_MENU                        00000000
INDEX_SUBMENU                     00000001
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
KNOWN_ZERO                        00000000
LCD_CNTL                          00000005
LCD_CNTL_TRIS                     00000085
LCD_DATA                          00000006
LCD_DATA_TRIS                     00000086
LOOP_DELAY                        00000377
LOOP_MENU                         000002CF
LOOP_SUBMENU                      00000333
MAIN                              00000000
MENU_1                            000000E9
MENU_1_SUBMENU_1                  0000013E
MENU_1_SUBMENU_1_ACTION           0000026A
MENU_1_SUBMENU_2                  00000152
MENU_1_SUBMENU_2_ACTION           0000026B
MENU_1_SUBMENU_3                  00000166
MENU_1_SUBMENU_3_ACTION           0000026C
MENU_1_TABLE                      0000006E
MENU_1_TABLE_ACTION               000000B2
MENU_2                            000000FA
MENU_2_SUBMENU_1                  0000017A
MENU_2_SUBMENU_1_ACTION           0000026D
MENU_2_SUBMENU_2                  0000018E
MENU_2_SUBMENU_2_ACTION           0000026E
MENU_2_SUBMENU_3                  000001A2
MENU_2_SUBMENU_3_ACTION           0000026F
MENU_2_TABLE                      00000079
MENU_2_TABLE_ACTION               000000BD
MENU_3                            0000010B
MENU_3_SUBMENU_1                  000001B6
MENU_3_SUBMENU_1_ACTION           00000270
MENU_3_SUBMENU_2                  000001CA
MENU_3_SUBMENU_2_ACTION           00000271
MENU_3_SUBMENU_3                  000001DE
MENU_3_SUBMENU_3_ACTION           00000272
MENU_3_TABLE                      00000084
MENU_3_TABLE_ACTION               000000C8
MENU_4                            0000011C
MENU_4_SUBMENU_1                  000001F2
MENU_4_SUBMENU_1_ACTION           00000273
MENU_4_SUBMENU_2                  00000206
MENU_4_SUBMENU_2_ACTION           00000274
MENU_4_SUBMENU_3                  0000021A
MENU_4_SUBMENU_3_ACTION           00000275
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 49


SYMBOL TABLE
  LABEL                             VALUE 

MENU_4_TABLE                      0000008F
MENU_4_TABLE_ACTION               000000D3
MENU_5                            0000012D
MENU_5_SUBMENU_1                  0000022E
MENU_5_SUBMENU_1_ACTION           00000276
MENU_5_SUBMENU_2                  00000242
MENU_5_SUBMENU_2_ACTION           00000277
MENU_5_SUBMENU_3                  00000256
MENU_5_SUBMENU_3_ACTION           00000278
MENU_5_TABLE                      0000009A
MENU_5_TABLE_ACTION               000000DE
MENU_COUNTER                      00000003
MENU_HEANDLER                     00000290
MENU_NAME_1                       "1.Menu_1"
MENU_NAME_2                       "2.Menu_2"
MENU_NAME_3                       "3.Menu_3"
MENU_NAME_4                       "4.Menu_4"
MENU_NAME_5                       "5.Menu_5"
MENU_SUBMENU_NAME_1_1             "1.1.SubMenu"
MENU_SUBMENU_NAME_1_2             "1.2.SubMenu"
MENU_SUBMENU_NAME_1_3             "1.3.SubMenu"
MENU_SUBMENU_NAME_2_1             "2.1.SubMenu"
MENU_SUBMENU_NAME_2_2             "2.2.SubMenu"
MENU_SUBMENU_NAME_2_3             "2.3.SubMenu"
MENU_SUBMENU_NAME_3_1             "3.1.SubMenu"
MENU_SUBMENU_NAME_3_2             "3.2.SubMenu"
MENU_SUBMENU_NAME_3_3             "3.3.SubMenu"
MENU_SUBMENU_NAME_4_1             "4.1.SubMenu"
MENU_SUBMENU_NAME_4_2             "4.2.SubMenu"
MENU_SUBMENU_NAME_4_3             "4.3.SubMenu"
MENU_SUBMENU_NAME_5_1             "5.1.SubMenu"
MENU_SUBMENU_NAME_5_2             "5.2.SubMenu"
MENU_SUBMENU_NAME_5_3             "5.3.SubMenu"
MOD_PCL                           
N                                 00000000
NEXT_STRING                       0000036C
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
NUM_OF_MAIN_MENU_PUNKTS           .5
NUM_OF_SUBMENU_PUNKTS_1           .3
NUM_OF_SUBMENU_PUNKTS_2           .3
NUM_OF_SUBMENU_PUNKTS_3           .3
NUM_OF_SUBMENU_PUNKTS_4           .3
NUM_OF_SUBMENU_PUNKTS_5           .3
NUM_OF_SUBMENU_TABLE              00000047
OFFSET                            00000000
ONLY_WRITE                        00000001
OPTION_REG                        00000081
OUT_ACTION_COMPLETE               0000035B
OUT_FIRST_STRING                  00000369
OUT_NEXT_STRING                   00000373
PCL                               00000002
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 50


SYMBOL TABLE
  LABEL                             VALUE 

PCLATH                            0000000A
POP                               
PORTA                             00000005
PORTB                             00000006
PRESSING_DOWN                     000002B4
PRESSING_DOWN_2                   00000317
PRESS_DOWN                        FLAGS,1
PRESS_ENTER                       FLAGS,3
PRESS_EXIT                        FLAGS,2
PRESS_UP                          FLAGS,0
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PUSH                              
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RD                                00000000
RETLW_NUM_OF_SUBMENU_PUNKTS       
RP0                               00000005
RP1                               00000006
RS                                00000003
SECOND_LINE                       000000C0
SECOND_STRING_ROUTINE             0000027D
SEND_LCD_COMMAND                  00000000
SEND_LCD_SYMBOL                   00000000
SKIP_CHECK_1                      0000029E
SKIP_CHECK_2                      00000300
SKIP_CORRECT_INDEX_MENU_2         000002C1
SKIP_CORRECT_INDEX_MENU_3         000002C6
SKIP_CORRECT_INDEX_SUBMENU_2      00000325
SKIP_CORRECT_INDEX_SUBMENU_3      0000032A
STATUS                            00000003
STRING_ACTION_COMPLETE            00000354
STRING_MENU                       00000281
STRING_SUBMENU                    00000289
SWITCH_ACTION                     000000A5
SWITCH_MENU                       00000291
SWITCH_MENU_ROUTINE               00000280
SWITCH_MENU_TABLE                 00000054
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 51


SYMBOL TABLE
  LABEL                             VALUE 

SWITCH_SUBMENU                    000002F0
SWITCH_SUBMENU_ROUTINE            00000288
SWITCH_SUBMENU_TABLE              00000061
SYMBOL_POINTER                    00000002
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TABLE_ACTION_COMPLETE             00000000
TABLE_ZASTAVKA_FIRST_STRING       00000019
TABLE_ZASTAVKA_SECOND_STRING      00000030
TEMP_1                            00000004
TEMP_2                            00000005
TEMP_3                            00000006
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
UP                                PORTB,4
USE_4_BIT_MODE                    00000001
USE_HIGH_NIBLE                    00000000
USE_MENU_ACTION                   0
USE_MOVING_CURSOR                 1
USE_ONE_PORT                      00000000
USE_RBIE                          1
USE_SHORT_MOD_PCL                 1
USE_STATIC_CURSOR                 0
USE_TOP_LAST_CURSOR               1
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Y                                 00000001
Z                                 00000002
ZASTAVKA                          00000360
ZASTAVKA_FIRST_STRING             "  MicroMenuLib"
ZASTAVKA_SECOND_STRING            "  ver 1.0 beta"
_CONFIG                           00002007
_CP_OFF                           00003FFF
MPASM  5.51                 MICROMENU_LIB.ASM   12-15-2018  10:35:27         PAGE 52


SYMBOL TABLE
  LABEL                             VALUE 

_CP_ON                            0000000F
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_MICROMENU_035E                   0000035E
_MICROMENU_037D                   0000037D
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84                           00000001

Errors   :     0
Warnings :   196 reported,     0 suppressed
Messages :    37 reported,     0 suppressed

