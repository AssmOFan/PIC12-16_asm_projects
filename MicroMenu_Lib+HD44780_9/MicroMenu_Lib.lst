MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001         include MicroMenu_Lib.h
                      00001 ; Микроменю на базе двухстрочного индикатора HD44780 и четырехпозиционного джойстика (крестовины кнопок)
                      00002 
Warning[205]: Found directive in column 1. (include)
                      00003 include hardware_profile.inc
                      00001         include p16f84.inc
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F84 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00206         LIST
                      00002         list p=16f84
Warning[205]: Found directive in column 1. (include)
                      00004 include Macro.h 
                      00001 #define USE_SHORT_MOD_PCL       1       ; Использовать "укороченную" версию макроса модификации PCL, поз
                            воляет экономить 1 слово памяти на каждом вызове макроса ценой 1 лишней ячейки ОЗУ
                      00002 
                      00003 push    macro
                      00004                 movwf   w_temp
                      00005                 swapf   STATUS,w
                      00006                 movwf   status_temp
                      00007                 endm
                      00008 
                      00009 pop             macro
                      00010                 swapf   status_temp,w
                      00011                 movwf   STATUS
                      00012                 swapf   w_temp,f
                      00013                 swapf   w_temp,w
                      00014                 endm
                      00015 
                      00016 mod_PCL macro   target                  ; Макрос, позволяет размещать таблицы на границах страниц
                      00017                 local   Table
                      00018                 movfw   target
                      00019                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
                      00020                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                      00021         if      USE_SHORT_MOD_PCL
                      00022                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
                      00023                 addlw   high Table              ; Загрузить 5 старших бит адреса
                      00024         else
                      00025                 movlw   high Table              ; Загрузить 5 старших бит адреса
                      00026                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                      00027                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                      00028         endif
                      00029                 movwf   PCLATH                  ; Установить старшую часть адреса
                      00030                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
                      00031                 movwf   PCL                             ; Установить младшую часть адреса
                      00032         Table
                      00033                 endm
                      00034 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00035 add_PCL macro   target,address  ; Макрос, позволяет удобно указывать страницу для следующего за ним кода
                      00036                                 movfw   target  
                      00037                                 clrf    PCLATH
                      00038                         if      (address==0x100)
                      00039                                 bsf             PCLATH,0
                      00040                         endif
                      00041                         if      (address==0x200)
                      00042                                 bsf             PCLATH,1
                      00043                         endif
                      00044                         if      (address==0x300)
                      00045                                 bsf             PCLATH,0                                
                      00046                                 bsf             PCLATH,1
                      00047                         endif
                      00048                         if      (address==0x400)
                      00049                                 bsf             PCLATH,2                                
                      00050                         endif
                      00051                                 addwf   PCL
                      00052                                 endm
                      00005 
                      00006 #define UP                                              PORTB,4
                      00007 #define DOWN                                    PORTB,5
                      00008 #define ENTER                                   PORTB,6
                      00009 #define EXIT                                    PORTB,7
                      00010 
                      00011 #define USE_CURSOR                              0                               ; Всегда рисовать курсор
                             в конце 1-й строчки
                      00012 #define USE_MOVING_CURSOR               1                               ; Использовать перемещаемый курс
                            ор (повышает удобство использования меню и размер прошивки)
                      00013 #define USE_TOP_4_FIRST_AND_BOTTOM_4_LAST       1       ; Использовать отображение "первый пункт всегда 
                            сверху" и "последний пункт всегда снизу"
                      00014 
                      00015         if      USE_MOVING_CURSOR
                      00016 #define Press_UP                                flags,0
                      00017 #define Press_DOWN                              flags,1
                      00018 #define Press_EXIT                              flags,2
                      00019 #define Press_ENTER                             flags,3 
                      00020         endif
                      00021 
                      00022 #define EXIT_DELAY                              .20                             ; Количество опросов кно
                            пок, до выхода в предыдущий уровень (* 0,8 сек)
                      00023 
                      00024 #define ZASTAVKA_FIRST_STRING   "  MicroMenuLib"
                      00025 #define ZASTAVKA_SECOND_STRING  "  ver 1.0 beta"
                      00026 
                      00027 #define NUM_OF_MAIN_MENU_PUNKTS .5                              ; Количество пунктов меню, до 10 
                      00028 
                      00029 #define MENU_NAME_1                             "1.Menu_1"
                      00030 #define MENU_NAME_2                             "2.Menu_2"
                      00031 #define MENU_NAME_3                             "3.Menu_3"
                      00032 #define MENU_NAME_4                             "4.Menu_4"
                      00033 #define MENU_NAME_5                             "5.Menu_5"      
                      00034 
                      00035 #define NUM_OF_SUBMENU_PUNKTS_1 .3                              ; Количество пунктов каждого подменю, до
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                             10
                      00036 
                      00037 #define MENU_SUBMENU_NAME_1_1   "1.1.Garage"
                      00038 #define MENU_SUBMENU_NAME_1_2   "1.2.Doors"
                      00039 #define MENU_SUBMENU_NAME_1_3   "1.3.House"
                      00040 
                      00041 #define NUM_OF_SUBMENU_PUNKTS_2 .3
                      00042 
                      00043 #define MENU_SUBMENU_NAME_2_1   "2.1.Garage"
                      00044 #define MENU_SUBMENU_NAME_2_2   "2.2.Doors"
                      00045 #define MENU_SUBMENU_NAME_2_3   "2.3.House"
                      00046                                 
                      00047 #define NUM_OF_SUBMENU_PUNKTS_3 .3
                      00048 
                      00049 #define MENU_SUBMENU_NAME_3_1   "3.1.Review"
                      00050 #define MENU_SUBMENU_NAME_3_2   "3.2.Shut Off"
                      00051 #define MENU_SUBMENU_NAME_3_3   "3.3.FAQ"
                      00052 
                      00053 #define NUM_OF_SUBMENU_PUNKTS_4 .3
                      00054 
                      00055 #define MENU_SUBMENU_NAME_4_1   "4.1.Review"
                      00056 #define MENU_SUBMENU_NAME_4_2   "4.2.Shut Off"
                      00057 #define MENU_SUBMENU_NAME_4_3   "4.3.FAQ"
                      00058 
                      00059 #define NUM_OF_SUBMENU_PUNKTS_5 .3
                      00060 
                      00061 #define MENU_SUBMENU_NAME_5_1   "5.1.Config"
                      00062 #define MENU_SUBMENU_NAME_5_2   "5.2.Settings"
                      00063 #define MENU_SUBMENU_NAME_5_3   "5.3.About"
                      00064 
                      00065 ;=======================================================================================================
                            =========
                      00066 Create_Menu_Names       macro                           ; Макрос, создает имена всех пунктов меню
                      00067                         local   a=1
                      00068                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
                      00069                                 Menu_#v(a)
                      00070                                         mod_PCL symbol_pointer
                      00071                                         dt              MENU_NAME_#v(a),0
                      00072                                         a+=1
                      00073                                 endw
                      00074                         endm
                      00075 
                      00076 ;=======================================================================================================
                            =========
                      00077 retlw_num_of_submenu_punkts     macro           ; Макрос, возвращает количество пунктов нужного подменю
                      00078                                 mod_PCL index_menu
                      00079                         local   a=1
                      00080                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
                      00081                                         retlw   NUM_OF_SUBMENU_PUNKTS_#v(a)
                      00082                                         a+=1
                      00083                                 endw
                      00084                         endm
                      00085 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00086 ;=======================================================================================================
                            =========
                      00087 goto_Punkt_Menu macro                                   ; Макрос, создает переходы на все пункты меню
                      00088                                 mod_PCL index_menu
                      00089                         local   a=1
                      00090                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
                      00091                                         goto    Menu_#v(a)
                      00092                                         a+=1
                      00093                                 endw
                      00094                         endm
                      00095 
                      00096 ;=======================================================================================================
                            =========
                      00097 goto_Punkt_Submenu      macro                           ; Макрос, создает переходы на все подпункты меню
                      00098                                         mod_PCL index_menu                              
                      00099                         local   c=1
                      00100                                 while   c<NUM_OF_MAIN_MENU_PUNKTS+1
                      00101                                         goto    Menu_#v(c)_Table
                      00102                                         c+=1
                      00103                                 endw
                      00104                         local   d=1
                      00105 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00106 ; Переходы на подпункты 1 пункта меню
                      00107 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00108                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00109                                 local   a=1     
                      00110                                 Menu_#v(d)_Table
                      00111                                         mod_PCL index_submenu
                      00112                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00113                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00114                                         a+=1
                      00115                                 endw
                      00116                                         d+=1
                      00117                                 endif
                      00118 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00119 ; Переходы на подпункты 2 пункта меню
                      00120 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00121                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00122                                 local   a=1     
                      00123                                 Menu_#v(d)_Table
                      00124                                         mod_PCL index_submenu
                      00125                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00126                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00127                                         a+=1
                      00128                                 endw
                      00129                                         d+=1
                      00130                                 endif
                      00131 ;-------------------------------------------------------------------------------------------------------
                            ----
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00132 ; Переходы на подпункты 3 пункта меню
                      00133 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00134                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00135                                 local   a=1     
                      00136                                 Menu_#v(d)_Table
                      00137                                         mod_PCL index_submenu
                      00138                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00139                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00140                                         a+=1
                      00141                                 endw
                      00142                                         d+=1
                      00143                                 endif
                      00144 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00145 ; Переходы на подпункты 4 пункта меню
                      00146 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00147                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00148                                 local   a=1     
                      00149                                 Menu_#v(d)_Table
                      00150                                         mod_PCL index_submenu
                      00151                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00152                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00153                                         a+=1
                      00154                                 endw
                      00155                                         d+=1
                      00156                                 endif
                      00157 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00158 ; Переходы на подпункты 5 пункта меню
                      00159 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00160                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00161                                 local   a=1     
                      00162                                 Menu_#v(d)_Table
                      00163                                         mod_PCL index_submenu
                      00164                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00165                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00166                                         a+=1
                      00167                                 endw
                      00168                                         d+=1
                      00169                                 endif
                      00170 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00171 ; Переходы на подпункты 6 пункта меню
                      00172 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00173                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00174                                 local   a=1     
                      00175                                 Menu_#v(d)_Table
                      00176                                         mod_PCL index_submenu
                      00177                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00178                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00179                                         a+=1
                      00180                                 endw
                      00181                                         d+=1
                      00182                                 endif
                      00183 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00184 ; Переходы на подпункты 7 пункта меню
                      00185 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00186                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00187                                 local   a=1     
                      00188                                 Menu_#v(d)_Table
                      00189                                         mod_PCL index_submenu
                      00190                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00191                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00192                                         a+=1
                      00193                                 endw
                      00194                                         d+=1
                      00195                                 endif
                      00196 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00197 ; Переходы на подпункты 8 пункта меню
                      00198 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00199                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00200                                 local   a=1     
                      00201                                 Menu_#v(d)_Table
                      00202                                         mod_PCL index_submenu
                      00203                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00204                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00205                                         a+=1
                      00206                                 endw
                      00207                                         d+=1
                      00208                                 endif
                      00209 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00210 ; Переходы на подпункты 9 пункта меню
                      00211 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00212                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00213                                 local   a=1     
                      00214                                 Menu_#v(d)_Table
                      00215                                         mod_PCL index_submenu
                      00216                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00217                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00218                                         a+=1
                      00219                                 endw
                      00220                                         d+=1
                      00221                                 endif
                      00222 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00223 ; Переходы на подпункты 10 пункта меню
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00224 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00225                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00226                                 local   a=1     
                      00227                                 Menu_#v(d)_Table
                      00228                                         mod_PCL index_submenu
                      00229                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00230                                         goto    Menu_#v(d)_Submenu_#v(a)
                      00231                                         a+=1
                      00232                                 endw
                      00233                                         d+=1
                      00234                                 endif           
                      00235 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00236                         endm
                      00237 
                      00238 ;=======================================================================================================
                            =========
                      00239 goto_Punkt_Submenu_action       macro           ; Макрос, создает переходы на действия всех подпунктов м
                            еню
                      00240                                         mod_PCL index_menu                              
                      00241                         local   c=1
                      00242                                 while   c<NUM_OF_MAIN_MENU_PUNKTS+1
                      00243                                         goto    Menu_#v(c)_Table_action
                      00244                                         c+=1
                      00245                                 endw
                      00246                         local   d=1
                      00247 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00248 ; Действия подпунктов 1 пункта меню
                      00249 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00250                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00251                                 local   a=1     
                      00252                                 Menu_#v(d)_Table_action
                      00253                                         mod_PCL index_submenu
                      00254                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00255                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00256                                         a+=1
                      00257                                 endw
                      00258                                         d+=1
                      00259                                 endif
                      00260 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00261 ; Действия подпунктов 2 пункта меню
                      00262 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00263                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00264                                 local   a=1     
                      00265                                 Menu_#v(d)_Table_action
                      00266                                         mod_PCL index_submenu
                      00267                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00268                                         goto    Menu_#v(d)_Submenu_#v(a)_action
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00269                                         a+=1
                      00270                                 endw
                      00271                                         d+=1
                      00272                                 endif
                      00273 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00274 ; Действия подпунктов 3 пункта меню
                      00275 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00276                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00277                                 local   a=1     
                      00278                                 Menu_#v(d)_Table_action
                      00279                                         mod_PCL index_submenu
                      00280                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00281                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00282                                         a+=1
                      00283                                 endw
                      00284                                         d+=1
                      00285                                 endif
                      00286 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00287 ; Действия подпунктов 4 пункта меню
                      00288 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00289                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00290                                 local   a=1     
                      00291                                 Menu_#v(d)_Table_action
                      00292                                         mod_PCL index_submenu
                      00293                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00294                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00295                                         a+=1
                      00296                                 endw
                      00297                                         d+=1
                      00298                                 endif
                      00299 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00300 ; Действия подпунктов 5 пункта меню
                      00301 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00302                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00303                                 local   a=1     
                      00304                                 Menu_#v(d)_Table_action
                      00305                                         mod_PCL index_submenu
                      00306                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00307                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00308                                         a+=1
                      00309                                 endw
                      00310                                         d+=1
                      00311                                 endif
                      00312 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00313 ; Действия подпунктов 6 пункта меню
                      00314 ;-------------------------------------------------------------------------------------------------------
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ----
                      00315                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00316                                 local   a=1     
                      00317                                 Menu_#v(d)_Table_action
                      00318                                         mod_PCL index_submenu
                      00319                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00320                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00321                                         a+=1
                      00322                                 endw
                      00323                                         d+=1
                      00324                                 endif
                      00325 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00326 ; Действия подпунктов 7 пункта меню
                      00327 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00328                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00329                                 local   a=1     
                      00330                                 Menu_#v(d)_Table_action
                      00331                                         mod_PCL index_submenu
                      00332                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00333                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00334                                         a+=1
                      00335                                 endw
                      00336                                         d+=1
                      00337                                 endif
                      00338 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00339 ; Действия подпунктов 8 пункта меню
                      00340 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00341                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00342                                 local   a=1     
                      00343                                 Menu_#v(d)_Table_action
                      00344                                         mod_PCL index_submenu
                      00345                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00346                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00347                                         a+=1
                      00348                                 endw
                      00349                                         d+=1
                      00350                                 endif
                      00351 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00352 ; Действия подпунктов 9 пункта меню
                      00353 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00354                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00355                                 local   a=1     
                      00356                                 Menu_#v(d)_Table_action
                      00357                                         mod_PCL index_submenu
                      00358                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00359                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00360                                         a+=1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00361                                 endw
                      00362                                         d+=1
                      00363                                 endif
                      00364 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00365 ; Действия подпунктов 10 пункта меню
                      00366 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00367                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00368                                 local   a=1     
                      00369                                 Menu_#v(d)_Table_action
                      00370                                         mod_PCL index_submenu
                      00371                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00372                                         goto    Menu_#v(d)_Submenu_#v(a)_action
                      00373                                         a+=1
                      00374                                 endw
                      00375                                         d+=1
                      00376                                 endif
                      00377 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00378                         endm
                      00379 
                      00380 ;===================================================================================================
                      00381 Create_Submenu_Names    macro                           ; Макрос, создает имена всех подпунктов меню
                      00382                                 local   d=1
                      00383 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00384 ; Подпункты 1 пункта меню
                      00385 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00386                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00387                                 local   a=1     
                      00388                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00389                                         Menu_#v(d)_Submenu_#v(a)
                      00390                                                 mod_PCL symbol_pointer
                      00391                                                 dt              MENU_SUBMENU_NAME_1_#v(a),0
                      00392                                         a+=1
                      00393                                 endw
                      00394                                         d+=1
                      00395                                 endif
                      00396 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00397 ; Подпункты 2 пункта меню
                      00398 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00399                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00400                                 local   a=1     
                      00401                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00402                                         Menu_#v(d)_Submenu_#v(a)
                      00403                                                 mod_PCL symbol_pointer
                      00404                                                 dt              MENU_SUBMENU_NAME_2_#v(a),0
                      00405                                         a+=1
                      00406                                 endw
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00407                                         d+=1
                      00408                                 endif
                      00409 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00410 ; Подпункты 3 пункта меню
                      00411 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00412                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00413                                 local   a=1     
                      00414                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00415                                         Menu_#v(d)_Submenu_#v(a)
                      00416                                                 mod_PCL symbol_pointer
                      00417                                                 dt              MENU_SUBMENU_NAME_3_#v(a),0
                      00418                                         a+=1
                      00419                                 endw
                      00420                                         d+=1
                      00421                                 endif
                      00422 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00423 ; Подпункты 4 пункта меню
                      00424 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00425                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00426                                 local   a=1     
                      00427                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00428                                         Menu_#v(d)_Submenu_#v(a)
                      00429                                                 mod_PCL symbol_pointer
                      00430                                                 dt              MENU_SUBMENU_NAME_4_#v(a),0
                      00431                                         a+=1
                      00432                                 endw
                      00433                                         d+=1
                      00434                                 endif
                      00435 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00436 ; Подпункты 5 пункта меню
                      00437 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00438                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00439                                 local   a=1     
                      00440                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00441                                         Menu_#v(d)_Submenu_#v(a)
                      00442                                                 mod_PCL symbol_pointer
                      00443                                                 dt              MENU_SUBMENU_NAME_5_#v(a),0
                      00444                                         a+=1
                      00445                                 endw
                      00446                                         d+=1
                      00447                                 endif
                      00448 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00449 ; Подпункты 6 пункта меню
                      00450 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00451                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00452                                 local   a=1     
                      00453                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00454                                         Menu_#v(d)_Submenu_#v(a)
                      00455                                                 mod_PCL symbol_pointer
                      00456                                                 dt              MENU_SUBMENU_NAME_6_#v(a),0
                      00457                                         a+=1
                      00458                                 endw
                      00459                                         d+=1
                      00460                                 endif
                      00461 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00462 ; Подпункты 7 пункта меню
                      00463 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00464                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00465                                 local   a=1     
                      00466                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00467                                         Menu_#v(d)_Submenu_#v(a)
                      00468                                                 mod_PCL symbol_pointer
                      00469                                                 dt              MENU_SUBMENU_NAME_7_#v(a),0
                      00470                                         a+=1
                      00471                                 endw
                      00472                                         d+=1
                      00473                                 endif
                      00474 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00475 ; Подпункты 8 пункта меню
                      00476 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00477                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00478                                 local   a=1     
                      00479                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00480                                         Menu_#v(d)_Submenu_#v(a)
                      00481                                                 mod_PCL symbol_pointer
                      00482                                                 dt              MENU_SUBMENU_NAME_8_#v(a),0
                      00483                                         a+=1
                      00484                                 endw
                      00485                                         d+=1
                      00486                                 endif
                      00487 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00488 ; Подпункты 9 пункта меню
                      00489 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00490                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00491                                 local   a=1     
                      00492                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00493                                                 mod_PCL symbol_pointer
                      00494                                                 dt              MENU_SUBMENU_NAME_9_#v(a),0
                      00495                                         a+=1
                      00496                                 endw
                      00497                                         d+=1
                      00498                                 endif
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00499 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00500 ; Подпункты 10 пункта меню
                      00501 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00502                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                      00503                                 local   a=1     
                      00504                                 while   a<NUM_OF_SUBMENU_PUNKTS_#v(d)+1
                      00505                                         Menu_#v(d)_Submenu_#v(a)
                      00506                                                 mod_PCL symbol_pointer
                      00507                                                 dt              MENU_SUBMENU_NAME_10_#v(a),0
                      00508                                         a+=1
                      00509                                 endw
                      00510                                         d+=1
                      00511                                 endif
                      00512 ;-------------------------------------------------------------------------------------------------------
                            ----
                      00513                         endm
                      00002         include HD44780_Lib.h
Warning[205]: Found directive in column 1. (include)
                      00001 include hardware_profile.inc
                      00003         include p16f84.inc
                      00207         LIST
                      00208 
                      00209 ;==========================================================================
                      00210 ;  MPASM PIC16F84 processor include
                      00211 ; 
                      00212 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00213 ;==========================================================================
                      00214 
Message[310]: Superseding current maximum RAM and RAM map.
                      00412         LIST
                      00004         list p=16f84
                      00002 
  00000001            00003 y                               equ             1                               ; YES
  00000000            00004 n                               equ             0                               ; NO
                      00005 
  00000001            00006 Use_4_bit_mode  equ             y                               ; YES/NO
  00000000            00007 Use_High_Nible  equ             n                               ; YES/NO
  00000000            00008 Use_One_Port    equ             n                               ; YES/NO
  00000001            00009 Only_Write              equ             y                               ; YES/NO
                      00010 
  00000006            00011 LCD_DATA                equ             PORTB                   ; Описываем порт линий данных
  00000086            00012 LCD_DATA_TRIS   equ             TRISB
                      00013 
                      00014         if      (Use_4_bit_mode && Use_One_Port); ; Если используем один порт для данных и линий управле
                            ниЯ
                      00015 
                      00016 LCD_CNTL                equ             LCD_DATA                ; то так и опишем
                      00017 LCD_CNTL_TRIS   equ             LCD_DATA_TRIS
                      00018 
                      00019         else
                      00020 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000005            00021 LCD_CNTL                equ             PORTA                   ; Иначе зададим любой другой
  00000085            00022 LCD_CNTL_TRIS   equ             TRISA
                      00023         endif
                      00024         
                      00025         if      (Use_4_bit_mode && Use_One_Port && Use_High_Nible && Only_Write)
                      00026 E                               equ             2
                      00027 RS                              equ             3
                      00028 CNTL_TRIS_MASK  equ             b'11110011'             ; Маска настройки линий управлениЯ
                      00029         endif
                      00030 
                      00031         if      (Use_4_bit_mode && Use_One_Port && Use_High_Nible && !Only_Write)
                      00032 E                               equ             1
                      00033 RW                              equ             2
                      00034 RS                              equ             3
                      00035 CNTL_TRIS_MASK  equ             b'11110001'             ; Маска настройки линий управлениЯ
                      00036         endif   
                      00037 
                      00038         if      (Use_4_bit_mode && Use_One_Port && !Use_High_Nible && Only_Write)
                      00039 E                               equ             4
                      00040 RS                              equ             5
                      00041 CNTL_TRIS_MASK  equ             b'11001111'             ; Маска настройки линий управлениЯ
                      00042         endif   
                      00043 
                      00044         if      (Use_4_bit_mode && Use_One_Port && !Use_High_Nible && !Only_Write)
                      00045 E                               equ             4
                      00046 RW                              equ             5
                      00047 RS                              equ             6
                      00048 CNTL_TRIS_MASK  equ             b'10001111'             ; Маска настройки линий управлениЯ
                      00049 
                      00050         else    ; Иначе присваиваем контрольным линиям любой другой порт и вибираем линии их по своему у
                            смотрению
                      00051         
  00000001            00052 E                               equ             1
  00000003            00053 RS                              equ             3
  000000F5            00054 CNTL_TRIS_MASK  equ             b'11110101'             ; Маска настройки линий управления
                      00055         endif
                      00056 
  0000000C            00057 DISP_ON                 EQU             b'00001100'             ; Display on
  0000000E            00058 DISP_ON_C               EQU             b'00001110'             ; Display on, Cursor on
  0000000F            00059 DISP_ON_B               EQU             b'00001111'             ; Display on, Cursor on, Blink cursor
  00000008            00060 DISP_OFF                EQU             b'00001000'             ; Display off
  00000001            00061 CLR_DISP                EQU             b'00000001'             ; Clear the Display
  00000006            00062 ENTRY_INC               EQU             b'00000110'             ; автоинкремент адреса, нет сдвига 
  00000007            00063 ENTRY_INC_S             EQU             b'00000111'             ; автоинкремент адреса, есть сдвиг
  00000004            00064 ENTRY_DEC               EQU             b'00000100'             ; автоинкремент адреса, нет сдвига 
  00000005            00065 ENTRY_DEC_S             EQU             b'00000101'             ;
  00000080            00066 DD_RAM_ADDR             EQU             b'10000000'             ; Least Significant 7-bit are for addres
                            s
  00000080            00067 DD_RAM_UL               EQU             b'10000000'             ; Upper Left coner of the Display
  000000C0            00068 SECOND_LINE             EQU             b'11000000'             ; Move cursor to second line
                      00069                                         
                      00003 
                      00004 MicroMenu_Lib_udata     udata_shr
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000                  00005 index_menu              res     1
0001                  00006 index_submenu   res     1
0002                  00007 symbol_pointer  res     1
0003                  00008 menu_counter    res     1
0004                  00009 temp_1                  res     1
0005                  00010 temp_2                  res     1
0006                  00011 temp_3                  res     1
                      00012 
Warning[205]: Found directive in column 1. (extern)
  0000                00013 extern  flags,offset
                      00014 
                      00015         if      USE_SHORT_MOD_PCL
Warning[205]: Found directive in column 1. (extern)
  0000                00016 extern  known_zero
                      00017         endif
                      00018 
  0000                00019         global  Menu_heandler,Zastavka_routine
  0000                00020         extern  Send_LCD_Symbol,Send_LCD_Command,Delay_4ms,Zastavka,Main
                      00021 ;===================================================================================================
                      00022 MicroMenu               code                                    ; Адрес начала сегмента кода библиотеки 
                            меню
                      00023 ;===================================================================================================
0000                  00024 Switch_Menu_Table                                               ; Переходим на нужный пункт меню
                      00025         goto_Punkt_Menu                                         ; Макрос, создает переходы на все пункты
                             меню. Первое GOTO должно находится по адресу 0x100                                             
                          M                                 mod_PCL index_menu
  0000                    M                 local   Table
0000   08??               M                 movfw   index_menu
0001   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0002   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0003   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0004   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0005   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0006   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0007   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0008                      M         Table
  0001                    M                         local   a=1
                          M                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
0008   2???               M                                         goto    Menu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0009   2???               M                                         goto    Menu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
000A   2???               M                                         goto    Menu_3
Warning[207]: Found label after column 1. (a)
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000004                M                                         a+=1
000B   2???               M                                         goto    Menu_4
Warning[207]: Found label after column 1. (a)
  00000005                M                                         a+=1
000C   2???               M                                         goto    Menu_5
Warning[207]: Found label after column 1. (a)
  00000006                M                                         a+=1
                          M                                 endw
                      00026 ;---------------------------------------------------------------------------------------------------
000D                  00027 Switch_Submenu_Table                                    ; Переходим на нужный подпункт меню
                      00028         goto_Punkt_Submenu                                      ; Макрос, создает переходы на все подпун
                            кты меню
                          M                                         mod_PCL index_menu                              
  0000                    M                 local   Table
000D   08??               M                 movfw   index_menu
000E   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
000F   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0010   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0011   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0012   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0013   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0014   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0015                      M         Table
  0001                    M                         local   c=1
                          M                                 while   c<NUM_OF_MAIN_MENU_PUNKTS+1
0015   2???               M                                         goto    Menu_1_Table
Warning[207]: Found label after column 1. (c)
  00000002                M                                         c+=1
0016   2???               M                                         goto    Menu_2_Table
Warning[207]: Found label after column 1. (c)
  00000003                M                                         c+=1
0017   2???               M                                         goto    Menu_3_Table
Warning[207]: Found label after column 1. (c)
  00000004                M                                         c+=1
0018   2???               M                                         goto    Menu_4_Table
Warning[207]: Found label after column 1. (c)
  00000005                M                                         c+=1
0019   2???               M                                         goto    Menu_5_Table
Warning[207]: Found label after column 1. (c)
  00000006                M                                         c+=1
                          M                                 endw
  0001                    M                         local   d=1
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 1 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_1_Table)
001A                      M                                 Menu_1_Table
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
001A   08??               M                 movfw   index_submenu
001B   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
001C   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
001D   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
001E   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
001F   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0020   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0021   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0022                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_1+1
0022   2???               M                                         goto    Menu_1_Submenu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0023   2???               M                                         goto    Menu_1_Submenu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0024   2???               M                                         goto    Menu_1_Submenu_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000002                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 2 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_2_Table)
0025                      M                                 Menu_2_Table
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
0025   08??               M                 movfw   index_submenu
0026   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0027   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0028   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0029   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
002A   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
002B   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
002C   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
002D                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_2+1
002D   2???               M                                         goto    Menu_2_Submenu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
002E   2???               M                                         goto    Menu_2_Submenu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
002F   2???               M                                         goto    Menu_2_Submenu_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000003                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 3 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_3_Table)
0030                      M                                 Menu_3_Table
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
0030   08??               M                 movfw   index_submenu
0031   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0032   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0033   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0034   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0035   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0036   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0037   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0038                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_3+1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0038   2???               M                                         goto    Menu_3_Submenu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0039   2???               M                                         goto    Menu_3_Submenu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
003A   2???               M                                         goto    Menu_3_Submenu_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000004                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 4 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_4_Table)
003B                      M                                 Menu_4_Table
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
003B   08??               M                 movfw   index_submenu
003C   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
003D   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
003E   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
003F   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0040   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0041   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0042   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0043                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_4+1
0043   2???               M                                         goto    Menu_4_Submenu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0044   2???               M                                         goto    Menu_4_Submenu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0045   2???               M                                         goto    Menu_4_Submenu_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000005                M                                         d+=1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 5 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_5_Table)
0046                      M                                 Menu_5_Table
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
0046   08??               M                 movfw   index_submenu
0047   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0048   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0049   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
004A   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
004B   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
004C   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
004D   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
004E                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_5+1
004E   2???               M                                         goto    Menu_5_Submenu_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
004F   2???               M                                         goto    Menu_5_Submenu_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0050   2???               M                                         goto    Menu_5_Submenu_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000006                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 6 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 7 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 8 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 9 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Переходы на подпункты 10 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif           
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                      00029 ;---------------------------------------------------------------------------------------------------
0051                  00030 Switch_Action                                                   ; Выполним действие, на котором находитс
                            я курсор 
                      00031         goto_Punkt_Submenu_action                       ; Макрос, создает переходы на действия всех подп
                            унктов меню
                          M                                         mod_PCL index_menu                              
  0000                    M                 local   Table
0051   08??               M                 movfw   index_menu
0052   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0053   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0054   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0055   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0056   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0057   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0058   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0059                      M         Table
  0001                    M                         local   c=1
                          M                                 while   c<NUM_OF_MAIN_MENU_PUNKTS+1
0059   2???               M                                         goto    Menu_1_Table_action
Warning[207]: Found label after column 1. (c)
  00000002                M                                         c+=1
005A   2???               M                                         goto    Menu_2_Table_action
Warning[207]: Found label after column 1. (c)
  00000003                M                                         c+=1
005B   2???               M                                         goto    Menu_3_Table_action
Warning[207]: Found label after column 1. (c)
  00000004                M                                         c+=1
005C   2???               M                                         goto    Menu_4_Table_action
Warning[207]: Found label after column 1. (c)
  00000005                M                                         c+=1
005D   2???               M                                         goto    Menu_5_Table_action
Warning[207]: Found label after column 1. (c)
  00000006                M                                         c+=1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                 endw
  0001                    M                         local   d=1
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 1 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_1_Table_action)
005E                      M                                 Menu_1_Table_action
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
005E   08??               M                 movfw   index_submenu
005F   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0060   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0061   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0062   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0063   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0064   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0065   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0066                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_1+1
0066   2???               M                                         goto    Menu_1_Submenu_1_action
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0067   2???               M                                         goto    Menu_1_Submenu_2_action
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0068   2???               M                                         goto    Menu_1_Submenu_3_action
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000002                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 2 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_2_Table_action)
0069                      M                                 Menu_2_Table_action
                          M                                         mod_PCL index_submenu
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M                 local   Table
0069   08??               M                 movfw   index_submenu
006A   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
006B   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
006C   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
006D   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
006E   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
006F   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0070   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0071                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_2+1
0071   2???               M                                         goto    Menu_2_Submenu_1_action
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0072   2???               M                                         goto    Menu_2_Submenu_2_action
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0073   2???               M                                         goto    Menu_2_Submenu_3_action
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000003                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 3 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_3_Table_action)
0074                      M                                 Menu_3_Table_action
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
0074   08??               M                 movfw   index_submenu
0075   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0076   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0077   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0078   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0079   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
007A   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
007B   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
007C                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_3+1
007C   2???               M                                         goto    Menu_3_Submenu_1_action
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
007D   2???               M                                         goto    Menu_3_Submenu_2_action
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
007E   2???               M                                         goto    Menu_3_Submenu_3_action
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000004                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 4 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_4_Table_action)
007F                      M                                 Menu_4_Table_action
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
007F   08??               M                 movfw   index_submenu
0080   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0081   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0082   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0083   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0084   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0085   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0086   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0087                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_4+1
0087   2???               M                                         goto    Menu_4_Submenu_1_action
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0088   2???               M                                         goto    Menu_4_Submenu_2_action
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0089   2???               M                                         goto    Menu_4_Submenu_3_action
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000005                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 5 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
Warning[207]: Found label after column 1. (Menu_5_Table_action)
008A                      M                                 Menu_5_Table_action
                          M                                         mod_PCL index_submenu
  0000                    M                 local   Table
008A   08??               M                 movfw   index_submenu
008B   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
008C   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
008D   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
008E   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
008F   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0090   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0091   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0092                      M         Table
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_5+1
0092   2???               M                                         goto    Menu_5_Submenu_1_action
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
0093   2???               M                                         goto    Menu_5_Submenu_2_action
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
0094   2???               M                                         goto    Menu_5_Submenu_3_action
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000006                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 6 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table_action
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4_action
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 7 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table_action
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4_action
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 8 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table_action
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4_action
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 9 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table_action
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4_action
                          M                                         a+=1
                          M                                 endw
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Действия подпунктов 10 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 Menu_6_Table_action
                          M                                         mod_PCL index_submenu
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         goto    Menu_6_Submenu_4_action
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                      00032 ;===================================================================================================
                      00033         Create_Menu_Names                                       ; Макрос, создает имена всех пунктов мен
                            ю
  0001                    M                         local   a=1
                          M                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
Warning[207]: Found label after column 1. (Menu_1)
0095                      M                                 Menu_1
                          M                                         mod_PCL symbol_pointer
  0000                    M                 local   Table
0095   08??               M                 movfw   symbol_pointer
0096   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0097   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0098   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0099   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
009A   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
009B   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
009C   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
009D                      M         Table
009D   3431 342E 344D     M                                         dt              MENU_NAME_1,0
       3465 346E 3475 
       345F 3431 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_2)
00A6                      M                                 Menu_2
                          M                                         mod_PCL symbol_pointer
  0000                    M                 local   Table
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A6   08??               M                 movfw   symbol_pointer
00A7   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00A8   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
00A9   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00AA   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00AB   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00AC   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00AD   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00AE                      M         Table
00AE   3432 342E 344D     M                                         dt              MENU_NAME_2,0
       3465 346E 3475 
       345F 3432 3400 
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_3)
00B7                      M                                 Menu_3
                          M                                         mod_PCL symbol_pointer
  0000                    M                 local   Table
00B7   08??               M                 movfw   symbol_pointer
00B8   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00B9   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
00BA   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00BB   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00BC   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00BD   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00BE   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00BF                      M         Table
00BF   3433 342E 344D     M                                         dt              MENU_NAME_3,0
       3465 346E 3475 
       345F 3433 3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_4)
00C8                      M                                 Menu_4
                          M                                         mod_PCL symbol_pointer
  0000                    M                 local   Table
00C8   08??               M                 movfw   symbol_pointer
00C9   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00CA   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if      USE_SHORT_MOD_PCL
00CB   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00CC   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00CD   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00CE   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00CF   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00D0                      M         Table
00D0   3434 342E 344D     M                                         dt              MENU_NAME_4,0
       3465 346E 3475 
       345F 3434 3400 
Warning[207]: Found label after column 1. (a)
  00000005                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_5)
00D9                      M                                 Menu_5
                          M                                         mod_PCL symbol_pointer
  0000                    M                 local   Table
00D9   08??               M                 movfw   symbol_pointer
00DA   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00DB   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
00DC   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00DD   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00DE   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00DF   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00E0   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00E1                      M         Table
00E1   3435 342E 344D     M                                         dt              MENU_NAME_5,0
       3465 346E 3475 
       345F 3435 3400 
Warning[207]: Found label after column 1. (a)
  00000006                M                                         a+=1
                          M                                 endw
                      00034 ;===================================================================================================
00EA                  00035 Num_of_Submenu_Table                                    
                      00036         retlw_num_of_submenu_punkts                     ; Макрос, возвращает количество подпунктов текущ
                            его пункта меню
                          M                                 mod_PCL index_menu
  0000                    M                 local   Table
00EA   08??               M                 movfw   index_menu
00EB   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00EC   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if      USE_SHORT_MOD_PCL
00ED   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00EE   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00EF   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00F0   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00F1   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00F2                      M         Table
  0001                    M                         local   a=1
                          M                                 while   a<NUM_OF_MAIN_MENU_PUNKTS+1
00F2   3403               M                                         retlw   NUM_OF_SUBMENU_PUNKTS_1
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
00F3   3403               M                                         retlw   NUM_OF_SUBMENU_PUNKTS_2
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
00F4   3403               M                                         retlw   NUM_OF_SUBMENU_PUNKTS_3
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
00F5   3403               M                                         retlw   NUM_OF_SUBMENU_PUNKTS_4
Warning[207]: Found label after column 1. (a)
  00000005                M                                         a+=1
00F6   3403               M                                         retlw   NUM_OF_SUBMENU_PUNKTS_5
Warning[207]: Found label after column 1. (a)
  00000006                M                                         a+=1
                          M                                 endw
                      00037 ;===================================================================================================
00F7                  00038 Table_Zastavka_First_String
                      00039         mod_PCL symbol_pointer
  0000                    M                 local   Table
00F7   08??               M                 movfw   symbol_pointer
00F8   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
00F9   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
00FA   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
00FB   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
00FC   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
00FD   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
00FE   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
00FF                      M         Table
00FF   3420 3420 344D 00040         dt              ZASTAVKA_FIRST_STRING,0
       3469 3463 3472 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       346F 344D 3465 
       346E 3475 344C 
       3469 3462 3400 
                      00041 
010E                  00042 Table_Zastavka_Second_String 
                      00043         mod_PCL symbol_pointer
  0000                    M                 local   Table
010E   08??               M                 movfw   symbol_pointer
010F   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0110   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0111   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0112   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0113   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0114   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0115   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0116                      M         Table
0116   3420 3420 3476 00044         dt              ZASTAVKA_SECOND_STRING,0
       3465 3472 3420 
       3431 342E 3430 
       3420 3462 3465 
       3474 3461 3400 
                      00045 
0125                  00046 Table_Action_Complete 
                      00047         mod_PCL symbol_pointer
  0000                    M                 local   Table
0125   08??               M                 movfw   symbol_pointer
0126   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0127   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0128   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0129   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
012A   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
012B   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
012C   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
012D                      M         Table
012D   3441 3463 3474 00048         dt              "Action Complete!",0
       3469 346F 346E 
       3420 3443 346F 
       346D 3470 346C 
       3465 3474 3465 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3421 3400 
                      00049 
                      00050 ;===================================================================================================
                      00051         Create_Submenu_Names                            ; Макрос, создает имена всех подпунктов меню
  0001                    M                                 local   d=1
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 1 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_1+1
Warning[207]: Found label after column 1. (Menu_1_Submenu_1)
013E                      M                                         Menu_1_Submenu_1
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
013E   08??               M                 movfw   symbol_pointer
013F   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0140   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0141   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0142   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0143   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0144   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0145   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0146                      M         Table
0146   3431 342E 3431     M                                                 dt              MENU_SUBMENU_NAME_1_1,0
       342E 3447 3461 
       3472 3461 3467 
       3465 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_1_Submenu_2)
0151                      M                                         Menu_1_Submenu_2
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
0151   08??               M                 movfw   symbol_pointer
0152   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0153   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0154   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0155   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
0156   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0157   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0158   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0159                      M         Table
0159   3431 342E 3432     M                                                 dt              MENU_SUBMENU_NAME_1_2,0
       342E 3444 346F 
       346F 3472 3473 
       3400 
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_1_Submenu_3)
0163                      M                                         Menu_1_Submenu_3
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
0163   08??               M                 movfw   symbol_pointer
0164   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0165   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0166   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0167   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0168   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0169   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
016A   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
016B                      M         Table
016B   3431 342E 3433     M                                                 dt              MENU_SUBMENU_NAME_1_3,0
       342E 3448 346F 
       3475 3473 3465 
       3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000002                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 2 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_2+1
Warning[207]: Found label after column 1. (Menu_2_Submenu_1)
0175                      M                                         Menu_2_Submenu_1
                          M                                                 mod_PCL symbol_pointer
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000                    M                 local   Table
0175   08??               M                 movfw   symbol_pointer
0176   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0177   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0178   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0179   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
017A   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
017B   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
017C   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
017D                      M         Table
017D   3432 342E 3431     M                                                 dt              MENU_SUBMENU_NAME_2_1,0
       342E 3447 3461 
       3472 3461 3467 
       3465 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_2_Submenu_2)
0188                      M                                         Menu_2_Submenu_2
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
0188   08??               M                 movfw   symbol_pointer
0189   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
018A   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
018B   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
018C   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
018D   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
018E   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
018F   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0190                      M         Table
0190   3432 342E 3432     M                                                 dt              MENU_SUBMENU_NAME_2_2,0
       342E 3444 346F 
       346F 3472 3473 
       3400 
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_2_Submenu_3)
019A                      M                                         Menu_2_Submenu_3
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

019A   08??               M                 movfw   symbol_pointer
019B   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
019C   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
019D   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
019E   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
019F   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01A0   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01A1   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
01A2                      M         Table
01A2   3432 342E 3433     M                                                 dt              MENU_SUBMENU_NAME_2_3,0
       342E 3448 346F 
       3475 3473 3465 
       3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000003                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 3 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_3+1
Warning[207]: Found label after column 1. (Menu_3_Submenu_1)
01AC                      M                                         Menu_3_Submenu_1
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
01AC   08??               M                 movfw   symbol_pointer
01AD   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
01AE   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
01AF   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
01B0   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
01B1   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01B2   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01B3   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01B4                      M         Table
01B4   3433 342E 3431     M                                                 dt              MENU_SUBMENU_NAME_3_1,0
       342E 3452 3465 
       3476 3469 3465 
       3477 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_3_Submenu_2)
01BF                      M                                         Menu_3_Submenu_2
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
01BF   08??               M                 movfw   symbol_pointer
01C0   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
01C1   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
01C2   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
01C3   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
01C4   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01C5   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01C6   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
01C7                      M         Table
01C7   3433 342E 3432     M                                                 dt              MENU_SUBMENU_NAME_3_2,0
       342E 3453 3468 
       3475 3474 3420 
       344F 3466 3466 
       3400 
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_3_Submenu_3)
01D4                      M                                         Menu_3_Submenu_3
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
01D4   08??               M                 movfw   symbol_pointer
01D5   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
01D6   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
01D7   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
01D8   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
01D9   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01DA   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01DB   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01DC                      M         Table
01DC   3433 342E 3433     M                                                 dt              MENU_SUBMENU_NAME_3_3,0
       342E 3446 3441 
       3451 3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000004                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 4 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
  0001                    M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_4+1
Warning[207]: Found label after column 1. (Menu_4_Submenu_1)
01E4                      M                                         Menu_4_Submenu_1
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
01E4   08??               M                 movfw   symbol_pointer
01E5   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
01E6   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
01E7   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
01E8   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
01E9   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01EA   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01EB   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
01EC                      M         Table
01EC   3434 342E 3431     M                                                 dt              MENU_SUBMENU_NAME_4_1,0
       342E 3452 3465 
       3476 3469 3465 
       3477 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_4_Submenu_2)
01F7                      M                                         Menu_4_Submenu_2
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
01F7   08??               M                 movfw   symbol_pointer
01F8   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
01F9   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
01FA   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01FB   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
01FC   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
01FD   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
01FE   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
01FF                      M         Table
01FF   3434 342E 3432     M                                                 dt              MENU_SUBMENU_NAME_4_2,0
       342E 3453 3468 
       3475 3474 3420 
       344F 3466 3466 
       3400 
Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_4_Submenu_3)
020C                      M                                         Menu_4_Submenu_3
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
020C   08??               M                 movfw   symbol_pointer
020D   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
020E   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
020F   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0210   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0211   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0212   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0213   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0214                      M         Table
0214   3434 342E 3433     M                                                 dt              MENU_SUBMENU_NAME_4_3,0
       342E 3446 3441 
       3451 3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000005                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 5 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0001                    M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_5+1
Warning[207]: Found label after column 1. (Menu_5_Submenu_1)
021C                      M                                         Menu_5_Submenu_1
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
021C   08??               M                 movfw   symbol_pointer
021D   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
021E   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
021F   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0220   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0221   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0222   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0223   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0224                      M         Table
0224   3435 342E 3431     M                                                 dt              MENU_SUBMENU_NAME_5_1,0
       342E 3443 346F 
       346E 3466 3469 
       3467 3400 
Warning[207]: Found label after column 1. (a)
  00000002                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_5_Submenu_2)
022F                      M                                         Menu_5_Submenu_2
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
022F   08??               M                 movfw   symbol_pointer
0230   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0231   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0232   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0233   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0234   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
0235   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
0236   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
0237                      M         Table
0237   3435 342E 3432     M                                                 dt              MENU_SUBMENU_NAME_5_2,0
       342E 3453 3465 
       3474 3474 3469 
       346E 3467 3473 
       3400 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[207]: Found label after column 1. (a)
  00000003                M                                         a+=1
Warning[207]: Found label after column 1. (Menu_5_Submenu_3)
0244                      M                                         Menu_5_Submenu_3
                          M                                                 mod_PCL symbol_pointer
  0000                    M                 local   Table
0244   08??               M                 movfw   symbol_pointer
0245   3E??               M                 addlw   low Table               ; Добавить 8 младших бит адреса таблицы к смещению
0246   00??               M                 movwf   offset                  ; Сохранить младшие 8 бит требуемого адреса
                          M         if      USE_SHORT_MOD_PCL
0247   0D??               M                 rlf             known_zero,w    ; так сохраняют бит переполнения от сложения 
0248   3E??               M                 addlw   high Table              ; Загрузить 5 старших бит адреса
                          M         else
                          M                 movlw   high Table              ; Загрузить 5 старших бит адреса
                          M                 btfsc   STATUS,C                ; Перешли границу страницы памяти программ?
                          M                 addlw   1                               ; Если да, увеличить на 1 старшие 5 бит
                          M         endif
0249   008A               M                 movwf   PCLATH                  ; Установить старшую часть адреса
024A   08??               M                 movfw   offset                  ; Загрузить рассчитанное значание младшей части адреса
024B   0082               M                 movwf   PCL                             ; Установить младшую часть адреса
Warning[207]: Found label after column 1. (Table)
024C                      M         Table
024C   3435 342E 3433     M                                                 dt              MENU_SUBMENU_NAME_5_3,0
       342E 3441 3462 
       346F 3475 3474 
       3400 
Warning[207]: Found label after column 1. (a)
  00000004                M                                         a+=1
                          M                                 endw
Warning[207]: Found label after column 1. (d)
  00000006                M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 6 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         Menu_6_Submenu_4
                          M                                                 mod_PCL symbol_pointer
                          M                                                 dt              MENU_SUBMENU_NAME_6_4,0
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 7 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         Menu_6_Submenu_4
                          M                                                 mod_PCL symbol_pointer
                          M                                                 dt              MENU_SUBMENU_NAME_7_4,0
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 8 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         Menu_6_Submenu_4
                          M                                                 mod_PCL symbol_pointer
                          M                                                 dt              MENU_SUBMENU_NAME_8_4,0
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 9 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                                 mod_PCL symbol_pointer
                          M                                                 dt              MENU_SUBMENU_NAME_9_4,0
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M ; Подпункты 10 пункта меню
                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                          M                                 if              d<NUM_OF_MAIN_MENU_PUNKTS+1
                          M                                 local   a=1     
                          M                                 while   a<NUM_OF_SUBMENU_PUNKTS_6+1
                          M                                         Menu_6_Submenu_4
                          M                                                 mod_PCL symbol_pointer
                          M                                                 dt              MENU_SUBMENU_NAME_10_4,0
                          M                                         a+=1
                          M                                 endw
                          M                                         d+=1
                          M                                 endif
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;-------------------------------------------------------------------------------------------------------
                            ----
                      00052 ;===================================================================================================
0256                  00053 Menu_1_Submenu_1_action                                 ; Выполняем действие 1 подпункта 1 пункта
                      00054 ;       nop
0256   2???           00055         goto    End_Action
0257                  00056 Menu_1_Submenu_2_action                                 ; Выполняем действие 2 подпункта 1 пункта
                      00057 ;       nop
0257   2???           00058         goto    End_Action
0258                  00059 Menu_1_Submenu_3_action                                 ; Выполняем действие 3 подпункта 1 пункта
                      00060 ;       nop
0258   2???           00061         goto    End_Action
                      00062 ;---------------------------------------------------------------------------------------------------
0259                  00063 Menu_2_Submenu_1_action                                 ; Выполняем действие 1 подпункта 2 пункта
                      00064 ;       nop
0259   2???           00065         goto    End_Action
025A                  00066 Menu_2_Submenu_2_action                                 ; Выполняем действие 2 подпункта 2 пункта
                      00067 ;       nop
025A   2???           00068         goto    End_Action
025B                  00069 Menu_2_Submenu_3_action                                 ; Выполняем действие 3 подпункта 2 пункта
                      00070 ;       nop
025B   2???           00071         goto    End_Action
                      00072 ;---------------------------------------------------------------------------------------------------
025C                  00073 Menu_3_Submenu_1_action                                 ; Выполняем действие 1 подпункта 3 пункта
                      00074 ;       nop
025C   2???           00075         goto    End_Action
025D                  00076 Menu_3_Submenu_2_action                                 ; Выполняем действие 2 подпункта 3 пункта
                      00077 ;       nop
025D   2???           00078         goto    End_Action
025E                  00079 Menu_3_Submenu_3_action                                 ; Выполняем действие 3 подпункта 3 пункта
                      00080 ;       nop
025E   2???           00081         goto    End_Action
                      00082 ;---------------------------------------------------------------------------------------------------
025F                  00083 Menu_4_Submenu_1_action                                 ; Выполняем действие 1 подпункта 4 пункта
                      00084 ;       nop
025F   2???           00085         goto    End_Action
0260                  00086 Menu_4_Submenu_2_action                                 ; Выполняем действие 2 подпункта 4 пункта
                      00087 ;       nop
0260   2???           00088         goto    End_Action
0261                  00089 Menu_4_Submenu_3_action                                 ; Выполняем действие 3 подпункта 4 пункта
                      00090 ;       nop
0261   2???           00091         goto    End_Action                                                              
                      00092 ;---------------------------------------------------------------------------------------------------
0262                  00093 Menu_5_Submenu_1_action                                 ; Выполняем действие 1 подпункта 5 пункта
                      00094 ;       nop
0262   2???           00095         goto    End_Action
0263                  00096 Menu_5_Submenu_2_action                                 ; Выполняем действие 2 подпункта 5 пункта
                      00097 ;       nop
0263   2???           00098         goto    End_Action
0264                  00099 Menu_5_Submenu_3_action                                 ; Выполняем действие 3 подпункта 5 пункта
                      00100 ;       nop
0264   2???           00101         goto    End_Action                      
                      00102 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00103 ;===================================================================================================
0265                  00104 Debounce_CLR_DISP                                               ; Подпрограмма антидребезговой задержки 
                            сомещенной с очисткой дисплея
0265   2???           00105         call    Debounce_Delay
0266   3001           00106         movlw   CLR_DISP
0267   2???           00107         call    Send_LCD_Command
0268   2???           00108         call    Delay_4ms                                       ; Обязательная задержка после очистки ди
                            сплея !!!
0269   0008           00109         return
                      00110 
                      00111 ;===================================================================================================
026A                  00112 Second_String_routine                                   ; Подпрограмма перевода указателя на 2-ю строку 
Warning[205]: Found directive in column 1. (if)
                      00113 if      USE_CURSOR
                      00114         movlw   b'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки
                      00115         call    Send_LCD_Command
                      00116         movlw   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
                      00117         call    Send_LCD_Symbol
                      00118 endif
026A   30C0           00119         movlw   SECOND_LINE                                     ; Переводим указатель на 2-ю строку     
026B   2???           00120         call    Send_LCD_Command
026C   0008           00121         return                                                          ; И приступаем к отрисовке следу
                            ющего пункта меню
                      00122 
                      00123 ;===================================================================================================
026D                  00124 Switch_Menu_routine                                             ; Подпрограмма вывода названия пункта ме
                            ню на дисплей
026D   01??           00125         clrf    symbol_pointer
026E                  00126 String_Menu
026E   2???           00127         call    Switch_Menu_Table
026F   39FF           00128         andlw   0FFh
0270   1903           00129         btfsc   STATUS,Z
0271   0008           00130         return 
0272   2???           00131         call    Send_LCD_Symbol
Message[305]: Using default destination of 1 (file).
0273   0A??           00132         incf    symbol_pointer  
0274   2???           00133         goto    String_Menu
                      00134 ;-------------------------------------------------------------------------------------------------------
                            ---------------------
0275                  00135 Switch_Submenu_routine                                  ; Подпрограмма вывода названия подпункта меню на
                             дисплей
0275   01??           00136         clrf    symbol_pointer
0276                  00137 String_Submenu
0276   2???           00138         call    Switch_Submenu_Table
0277   39FF           00139         andlw   0FFh
0278   1903           00140         btfsc   STATUS,Z
0279   0008           00141         return 
027A   2???           00142         call    Send_LCD_Symbol
Message[305]: Using default destination of 1 (file).
027B   0A??           00143         incf    symbol_pointer  
027C   2???           00144         goto    String_Submenu
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00145 
                      00146 ;===================================================================================================
027D                  00147 Menu_heandler                                                   ; Обработчик меню
027D   01??           00148         clrf    index_menu                                      ; Была нажатая какая-то кнопка, очистим 
                            индекс пункта меню                                      
                      00149 
Warning[205]: Found directive in column 1. (if)
Warning[225]: Invalid label in operand (USE_TOP_4_FIRST_AND_BOTTOM_4_LAST)
                      00150 if      USE_MOVING_CURSOR & !USE_TOP_4_FIRST_AND_BOTTOM_4_LAST
                      00151         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00152         andwf   flags                                           
                      00153         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
                      00154 endif
                      00155 
027E                  00156 Switch_Menu                                                             ; Поместим курсор на нужный пунк
                            т меню                                                  
                      00157 
Warning[205]: Found directive in column 1. (if)
Warning[225]: Invalid label in operand (USE_TOP_4_FIRST_AND_BOTTOM_4_LAST)
                      00158 if      USE_MOVING_CURSOR & USE_TOP_4_FIRST_AND_BOTTOM_4_LAST
027E   08??           00159         movfw   index_menu
027F   1D03           00160         btfss   STATUS,Z
0280   2???           00161         goto    Check_1         
0281   30F0           00162         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
0282   05??           00163         andwf   flags   
0283   1400           00164         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
0284   2???           00165         goto    Skip_Check_1
0285                  00166 Check_1
0285   3C04           00167         sublw   NUM_OF_MAIN_MENU_PUNKTS-1       ; Сравниваем с количеством пунктов меню
0286   1D03           00168         btfss   STATUS,Z        
0287   2???           00169         goto    Skip_Check_1    
0288   30F0           00170         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
0289   05??           00171         andwf   flags
028A   1480           00172         bsf             Press_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
028B                  00173 Skip_Check_1
Warning[205]: Found directive in column 1. (endif)
                      00174 endif
                      00175 
028B   2???           00176         call    Debounce_CLR_DISP
                      00177 
Warning[205]: Found directive in column 1. (if)
                      00178 if      USE_MOVING_CURSOR
028C   1C00           00179         btfss   Press_UP
028D   2???           00180         goto    Pressing_DOWN                   
028E   2???           00181         call    Switch_Menu_routine                     ; Рисуем текущий пункт меню     
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

028F   308F           00182         movlw   b'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки       
0290   2???           00183         call    Send_LCD_Command
0291   303C           00184         movlw   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
0292   2???           00185         call    Send_LCD_Symbol
0293   2???           00186         call    Second_String_routine           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
0294   0A??           00187         incf    index_menu                                      ; Берем следующий пункт
0295   08??           00188         movfw   index_menu      
0296   3C05           00189         sublw   NUM_OF_MAIN_MENU_PUNKTS         ; Сравниваем с количеством пунктов меню
0297   1903           00190         btfsc   STATUS,Z
0298   2???           00191         goto    Correct_index_menu                      
0299   2???           00192         call    Switch_Menu_routine                     ; Рисуем пункт меню под текущим 
Message[305]: Using default destination of 1 (file).
029A   03??           00193         decf    index_menu                                      ; Не забудем вернуть назад текущий пункт
                             меню   
029B   2???           00194         goto    Skip_Correct_index_menu_3
029C                  00195 Correct_index_menu                                              ; Достигли последнего пункта меню, следу
                            ющим отображаем 1 пункт
029C   01??           00196         clrf    index_menu
029D   2???           00197         call    Switch_Menu_routine
029E   3004           00198         movlw   NUM_OF_MAIN_MENU_PUNKTS-1
029F   00??           00199         movwf   index_menu      
02A0   2???           00200         goto    Skip_Correct_index_menu_3
                      00201 
02A1                  00202 Pressing_DOWN
Message[305]: Using default destination of 1 (file).
02A1   03??           00203         decf    index_menu                                      ; Берем предыдущий пункт меню
02A2   1B80           00204         btfsc   index_menu,.7                           ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
02A3   2???           00205         goto    Correct_index_menu_2
02A4   2???           00206         call    Switch_Menu_routine                     ; Рисуем предыдущий пункт меню
02A5   2???           00207         call    Second_String_routine           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
02A6   0A??           00208         incf    index_menu                                      ; Вернем текущий пункт                  
                                            
02A7   08??           00209         movfw   index_menu      
02A8   2???           00210         goto    Skip_Correct_index_menu_2
02A9                  00211 Correct_index_menu_2
02A9   3004           00212         movlw   NUM_OF_MAIN_MENU_PUNKTS-1
02AA   00??           00213         movwf   index_menu
02AB   2???           00214         call    Switch_Menu_routine                     ; Рисуем предыдущий пункт меню
02AC   2???           00215         call    Second_String_routine           ; Указатель на 2 строку
02AD   01??           00216         clrf    index_menu
02AE                  00217 Skip_Correct_index_menu_2
02AE   2???           00218         call    Switch_Menu_routine                     ; Рисуем текущий пункт меню под предыдущим 
02AF   30CF           00219         movlw   b'11001111'                                     ; Установим курсор на последний символ 2
                            -й строки
02B0   2???           00220         call    Send_LCD_Command
02B1   303C           00221         movlw   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
02B2   2???           00222         call    Send_LCD_Symbol
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02B3                  00223 Skip_Correct_index_menu_3
                      00224 
Warning[205]: Found directive in column 1. (else)
                      00225 else
                      00226         call    Switch_Menu_routine                     ; Рисуем текущий пункт меню
                      00227         call    Second_String_routine           ; Указатель на 2 строку
                      00228         incf    index_menu                                      ; Берем следующий пункт
                      00229         movfw   index_menu      
                      00230         sublw   NUM_OF_MAIN_MENU_PUNKTS         ; Сравниваем с количеством пунктов меню
                      00231         btfsc   STATUS,Z
                      00232         goto    Correct_index_menu                      
                      00233         call    Switch_Menu_routine                     ; Рисуем пункт меню под текущим 
                      00234         decf    index_menu                                      ; Не забудем вернуть назад текущий пункт
                             меню   
                      00235         goto    Skip_Correct_index_menu
                      00236 Correct_index_menu                                              ; Достигли последнего пункта меню, следу
                            ющим отображаем 1 пункт
                      00237         clrf    index_menu
                      00238         call    Switch_Menu_routine
                      00239         movlw   NUM_OF_MAIN_MENU_PUNKTS-1
                      00240         movwf   index_menu      
                      00241 Skip_Correct_index_menu
                      00242 endif
                      00243 
02B3   3014           00244         movlw   EXIT_DELAY                                      ; Заносим счетчик проходов опроса клавиш
02B4   00??           00245         movwf   menu_counter
02B5   01??           00246         clrf    temp_1
02B6   01??           00247         clrf    temp_2
02B7                  00248 Loop_Menu                                                               ; Вычисляем нажатую клавишу
02B7   1E06           00249         btfss   UP
02B8   2???           00250         goto    Cursor_UP                               
02B9   1E86           00251         btfss   DOWN
02BA   2???           00252         goto    Cursor_DOWN
02BB   1F06           00253         btfss   ENTER
02BC   2???           00254         goto    ENTER_Menu
02BD   1F86           00255         btfss   EXIT
02BE   2???           00256         goto    EXIT_Menu
                      00257 ;-----------------------------------------------------------------                                      
                                                                    
Message[305]: Using default destination of 1 (file).
02BF   0B??           00258         decfsz  temp_1                                          ; Ни одна клавиша не нажата             
                                                            
02C0   2???           00259         goto    Loop_Menu                                       ; Цикл ожидания нажатия в главном меню  
Message[305]: Using default destination of 1 (file).
02C1   0B??           00260         decfsz  temp_2  
02C2   2???           00261         goto    Loop_Menu
Message[305]: Using default destination of 1 (file).
02C3   0B??           00262         decfsz  menu_counter                            ; Декремент счетчика проходов опроса клавиш     
02C4   2???           00263         goto    Loop_Menu
02C5   2???           00264         goto    Zastavka                                        ; Вышел таймаут нахождения в меню, выход
                            им в заставку   
                      00265 ;-----------------------------------------------------------------
02C6                  00266 Cursor_UP                                                               ; Была нажата клавиша "Вверх"
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02C6   2???           00267         call    Debounce_Delay
                      00268 
Warning[205]: Found directive in column 1. (if)
                      00269 if      USE_MOVING_CURSOR
02C7   30F0           00270         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02C8   05??           00271         andwf   flags                                           
02C9   1400           00272         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
Warning[205]: Found directive in column 1. (endif)
                      00273 endif
                      00274 
Message[305]: Using default destination of 1 (file).
02CA   03??           00275         decf    index_menu                                      ; Берем предыдущий пункт меню
02CB   1F80           00276         btfss   index_menu,.7                           ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
02CC   2???           00277         goto    Switch_Menu
02CD   3004           00278         movlw   NUM_OF_MAIN_MENU_PUNKTS-1       ; Стало "<0", сделаем текущим последний пункт меню. Учит
                            ываем, что индекс пункта меню на 1 меньше его порядкового номера
02CE   00??           00279         movwf   index_menu
02CF   2???           00280         goto    Switch_Menu                                     ; Отрисовываем новый текущий пункт меню
                      00281 ;-----------------------------------------------------------------
02D0                  00282 Cursor_DOWN                                                             ; Была нажата клавиша "Вниз"
02D0   2???           00283         call    Debounce_Delay
                      00284 
Warning[205]: Found directive in column 1. (if)
                      00285 if      USE_MOVING_CURSOR
02D1   30F0           00286         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02D2   05??           00287         andwf   flags                                           
02D3   1480           00288         bsf             Press_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
Warning[205]: Found directive in column 1. (endif)
                      00289 endif
                      00290 
Message[305]: Using default destination of 1 (file).
02D4   0A??           00291         incf    index_menu                                      ; Берем следущий пункт меню
02D5   08??           00292         movfw   index_menu
02D6   3C05           00293         sublw   NUM_OF_MAIN_MENU_PUNKTS         ; Достигли последнего ?
02D7   1903           00294         btfsc   STATUS,Z
02D8   01??           00295         clrf    index_menu                                      ; Если да, делаем текущим первый пункт м
                            еню     
02D9   2???           00296         goto    Switch_Menu                                     ; Отрисовываем новый текущий пункт меню
                      00297 ;-----------------------------------------------------------------
02DA                  00298 EXIT_Menu                                                               ; Была нажата клавиша "Выход"
02DA   2???           00299         call    Debounce_Delay
02DB   2???           00300         goto    Zastavka                                        ; Выходим в заставку
                      00301 ;-----------------------------------------------------------------
02DC                  00302 ENTER_Menu                                                              ; Была нажата клавиша "Вход"
02DC   01??           00303         clrf    index_submenu                           ; Очистим индекс пункта подменю 
                      00304 
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (if)
Warning[225]: Invalid label in operand (USE_TOP_4_FIRST_AND_BOTTOM_4_LAST)
                      00305 if      USE_MOVING_CURSOR & !USE_TOP_4_FIRST_AND_BOTTOM_4_LAST
                      00306         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
                      00307         andwf   flags                                           
                      00308         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
                      00309 endif
                      00310 
02DD                  00311 Switch_Submenu                                                  ; Поместим курсор на нужный подпункт нуж
                            ного пункта
                      00312 
Warning[205]: Found directive in column 1. (if)
Warning[225]: Invalid label in operand (USE_TOP_4_FIRST_AND_BOTTOM_4_LAST)
                      00313 if      USE_MOVING_CURSOR & USE_TOP_4_FIRST_AND_BOTTOM_4_LAST
02DD   08??           00314         movfw   index_submenu
02DE   1D03           00315         btfss   STATUS,Z
02DF   2???           00316         goto    Check_2         
02E0   30F0           00317         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02E1   05??           00318         andwf   flags   
02E2   1400           00319         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
02E3   2???           00320         goto    Skip_Check_2
02E4                  00321 Check_2
02E4   2???           00322         call    Num_of_Submenu_Table                    
02E5   00??           00323         movwf   temp_1  
02E6   03??           00324         decf    temp_1, w                                       ; Учитываем, что индекс подпункта начина
                            ется с 0
02E7   02??           00325         subwf   index_submenu,w                         ; Сравниваем с количеством подпунктов меню
02E8   1D03           00326         btfss   STATUS,Z        
02E9   2???           00327         goto    Skip_Check_2    
02EA   30F0           00328         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
02EB   05??           00329         andwf   flags
02EC   1480           00330         bsf             Press_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
02ED                  00331 Skip_Check_2
Warning[205]: Found directive in column 1. (endif)
                      00332 endif
                      00333 
02ED   2???           00334         call    Debounce_CLR_DISP
                      00335 
Warning[205]: Found directive in column 1. (if)
                      00336 if      USE_MOVING_CURSOR
02EE   1C00           00337         btfss   Press_UP
02EF   2???           00338         goto    Pressing_DOWN_2                 
02F0   2???           00339         call    Switch_Submenu_routine          ; Рисуем текущий подпункт меню  
02F1   308F           00340         movlw   b'10001111'                                     ; Установим курсор на последний символ 1
                            -й строки       
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02F2   2???           00341         call    Send_LCD_Command
02F3   303C           00342         movlw   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
02F4   2???           00343         call    Send_LCD_Symbol
02F5   2???           00344         call    Second_String_routine           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
02F6   0A??           00345         incf    index_submenu                           ; Берем следующий пункт
02F7   2???           00346         call    Num_of_Submenu_Table                    
02F8   02??           00347         subwf   index_submenu,w                         ; Сравниваем с количеством подпунктов меню
02F9   1903           00348         btfsc   STATUS,Z
02FA   2???           00349         goto    Correct_index_submenu                   
02FB   2???           00350         call    Switch_Submenu_routine          ; Рисуем подпункт меню под текущим 
Message[305]: Using default destination of 1 (file).
02FC   03??           00351         decf    index_submenu                           ; Не забудем вернуть назад текущий пункт меню   
02FD   2???           00352         goto    Skip_Correct_index_submenu_3
02FE                  00353 Correct_index_submenu                                   ; Достигли последнего подпункта меню, следующим 
                            отображаем 1 подпункт
02FE   01??           00354         clrf    index_submenu
02FF   2???           00355         call    Switch_Submenu_routine
0300   2???           00356         call    Num_of_Submenu_Table
0301   00??           00357         movwf   index_submenu
Message[305]: Using default destination of 1 (file).
0302   03??           00358         decf    index_submenu                           ; Учитываем, что индекс подпункта начинается с 0
                                    
0303   2???           00359         goto    Skip_Correct_index_submenu_3
                      00360 
0304                  00361 Pressing_DOWN_2
Message[305]: Using default destination of 1 (file).
0304   03??           00362         decf    index_submenu                           ; Берем предыдущий пункт меню
0305   1B80           00363         btfsc   index_submenu,.7                        ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов меню ограничено 64
0306   2???           00364         goto    Correct_index_submenu_2
0307   2???           00365         call    Switch_Submenu_routine          ; Рисуем предыдущий пункт меню
0308   2???           00366         call    Second_String_routine           ; Указатель на 2 строку
Message[305]: Using default destination of 1 (file).
0309   0A??           00367         incf    index_submenu                           ; Вернем текущий пункт                          
                                    
030A   08??           00368         movfw   index_submenu   
030B   2???           00369         goto    Skip_Correct_index_submenu_2
030C                  00370 Correct_index_submenu_2
030C   2???           00371         call    Num_of_Submenu_Table            ; Стало "<0", возвращаем количество пунктов в даном подм
                            еню     
030D   00??           00372         movwf   index_submenu                           ; Сделаем текущим последний пункт подменю
Message[305]: Using default destination of 1 (file).
030E   03??           00373         decf    index_submenu                           ; Учитываем, что индекс пункта подменю на 1 мень
                            ше его порядкового номера
030F   2???           00374         call    Switch_Submenu_routine          ; Рисуем предыдущий пункт меню
0310   2???           00375         call    Second_String_routine           ; Указатель на 2 строку
0311   01??           00376         clrf    index_submenu
0312                  00377 Skip_Correct_index_submenu_2
0312   2???           00378         call    Switch_Submenu_routine          ; Рисуем текущий пункт меню под предыдущим 
0313   30CF           00379         movlw   b'11001111'                                     ; Установим курсор на последний символ 2
                            -й строки
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0314   2???           00380         call    Send_LCD_Command
0315   303C           00381         movlw   '<'                                                     ; И нарисуем там указатель текущ
                            его пункта меню
0316   2???           00382         call    Send_LCD_Symbol
0317                  00383 Skip_Correct_index_submenu_3
                      00384 
Warning[205]: Found directive in column 1. (else)
                      00385 else
                      00386         call    Switch_Submenu_routine          ; Рисуем текущий подпункт меню  
                      00387         call    Second_String_routine           ; Указатель на 2 строку
                      00388         incf    index_submenu
                      00389         call    Num_of_Submenu_Table                    
                      00390         subwf   index_submenu,w                         ; Сравниваем с количеством подпунктов меню
                      00391         btfsc   STATUS,Z
                      00392         goto    Correct_index_submenu
                      00393         call    Switch_Submenu_routine          ; Рисуем подпункт меню под текущим 
                      00394         decf    index_submenu                           ; Не забудем вернуть назад текущий подпункт меню
                      00395         goto    Skip_Correct_index_submenu      
                      00396 Correct_index_submenu                                   ; Достигли последнего подпункта меню, следующим 
                            отображаем 1 подпункт
                      00397         clrf    index_submenu   
                      00398         call    Switch_Submenu_routine
                      00399         call    Num_of_Submenu_Table
                      00400         movwf   index_submenu   
                      00401         decf    index_submenu                           ; Учитываем, что индекс подпункта начинается с 0
                      00402 Skip_Correct_index_submenu
                      00403 endif
                      00404 
0317   3014           00405         movlw   EXIT_DELAY                                      ; Заносим счетчик проходов опроса клавиш
0318   00??           00406         movwf   menu_counter
0319   01??           00407         clrf    temp_1
031A   01??           00408         clrf    temp_2
031B                  00409 Loop_Submenu                                                    ; Мы зашли в пункт меню, ждем нажатия сл
                            едующей кнопки
031B   1E06           00410         btfss   UP
031C   2???           00411         goto    Cursor_UP_submenu                               
031D   1E86           00412         btfss   DOWN
031E   2???           00413         goto    Cursor_DOWN_submenu
031F   1F06           00414         btfss   ENTER
0320   2???           00415         goto    ENTER_submenu
0321   1F86           00416         btfss   EXIT
0322   2???           00417         goto    EXIT_submenu
                      00418 ;-----------------------------------------------------------------
Message[305]: Using default destination of 1 (file).
0323   0B??           00419         decfsz  temp_1                                          ; Ни одна клавиша не нажата     
0324   2???           00420         goto    Loop_Submenu                            ; Цикл ожидания нажатия в пункте меню
Message[305]: Using default destination of 1 (file).
0325   0B??           00421         decfsz  temp_2  
0326   2???           00422         goto    Loop_Submenu
Message[305]: Using default destination of 1 (file).
0327   0B??           00423         decfsz  menu_counter                            ; Декремент счетчика проходов опроса клавиш     
                                    
0328   2???           00424         goto    Loop_Submenu
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0329   2???           00425         goto    Switch_Menu                                     ; Вышел таймаут нахождения в подменю, вы
                            ходим в предыдущий пункт меню
                      00426 ;-----------------------------------------------------------------
032A                  00427 Cursor_UP_submenu                                               ; Была нажата клавиша "Вверх"
032A   2???           00428         call    Debounce_Delay
                      00429 
Warning[205]: Found directive in column 1. (if)
                      00430 if      USE_MOVING_CURSOR
032B   30F0           00431         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
032C   05??           00432         andwf   flags                                           
032D   1400           00433         bsf             Press_UP                                        ; И установим признак нажатия то
                            лько для кнопки "ВВЕРХ"
Warning[205]: Found directive in column 1. (endif)
                      00434 endif
                      00435 
Message[305]: Using default destination of 1 (file).
032E   03??           00436         decf    index_submenu                           ; Берем предыдущий пункт подменю
032F   1F80           00437         btfss   index_submenu,.7                        ; Проверяем на "<0"     простой проверкой 7 бита
                            , максимальное количество пунктов подменю ограничено 64
0330   2???           00438         goto    Switch_Submenu  
0331   2???           00439         call    Num_of_Submenu_Table            ; Стало "<0", возвращаем количество пунктов в даном подм
                            еню     
0332   00??           00440         movwf   index_submenu                           ; Сделаем текущим последний пункт подменю
Message[305]: Using default destination of 1 (file).
0333   03??           00441         decf    index_submenu                           ; Учитываем, что индекс пункта подменю на 1 мень
                            ше его порядкового номера
0334   2???           00442         goto    Switch_Submenu                          ; Отрисовываем новый текущий подпункт меню      
                      00443 ;-----------------------------------------------------------------
0335                  00444 Cursor_DOWN_submenu                                             ; Была нажата клавиша "Вниз"
0335   2???           00445         call    Debounce_Delay
                      00446 
Warning[205]: Found directive in column 1. (if)
                      00447 if      USE_MOVING_CURSOR
0336   30F0           00448         movlw   b'11110000'                                     ; Сбросим признак нажатия для всех кнопо
                            к                                       
Message[305]: Using default destination of 1 (file).
0337   05??           00449         andwf   flags                                           
0338   1480           00450         bsf             Press_DOWN                                      ; И установим признак нажатия то
                            лько для кнопки "ВНИЗ"
Warning[205]: Found directive in column 1. (endif)
                      00451 endif
                      00452 
Message[305]: Using default destination of 1 (file).
0339   0A??           00453         incf    index_submenu                           ; Берем следущий пункт подменю
033A   2???           00454         call    Num_of_Submenu_Table            ; Возвращаем количество пунктов в даном подменю 
033B   02??           00455         subwf   index_submenu,w                         ; Достигли последнего ? 
033C   1903           00456         btfsc   STATUS,Z
033D   01??           00457         clrf    index_submenu                           ; Если да, делаем текущим первый подпункт меню  
                                    
033E   2???           00458         goto    Switch_Submenu                          ; Отрисовываем новый текущий подпункт меню
                      00459 ;-----------------------------------------------------------------      
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

033F                  00460 EXIT_submenu                                                    ; Была нажата клавиша "Выход"
033F   2???           00461         call    Debounce_Delay
0340   01??           00462         clrf    index_submenu                           ; Обнуляем индекс пункта подменю, чтобы при след
                            ующем заходе в любой пункт меню курсор находился на 1 пункте подменю                    
0341   2???           00463         goto    Switch_Menu                                     ; Выходим в меню
                      00464 ;-----------------------------------------------------------------
0342                  00465 ENTER_submenu                                                   ; Была нажата клавиша "Вход"
0342   2???           00466         call    Debounce_CLR_DISP                       ; Очистим дисплей
0343   2???           00467         goto    Switch_Action                           ; Делаем действие текущего подпункта меню
0344                  00468 End_Action
                      00469 ;-----------------------------------------------------------------
0344   01??           00470         clrf    symbol_pointer                          ; Рисуем подтверждение действия
0345                  00471 String_Action_Complete
0345   2???           00472         call    Table_Action_Complete   
0346   39FF           00473         andlw   0FFh
0347   1903           00474         btfsc   STATUS,Z
0348   2???           00475         goto    Out_Action_Complete
0349   2???           00476         call    Send_LCD_Symbol
Message[305]: Using default destination of 1 (file).
034A   0A??           00477         incf    symbol_pointer  
034B   2???           00478         goto    String_Action_Complete
034C                  00479 Out_Action_Complete
034C   01??           00480         clrf    temp_3                                          ; Задержка, чтобы успеть прочесть уведом
                            ление о выполнении действи
034D   2???           00481         call    Debounce_Delay
Message[305]: Using default destination of 1 (file).
034E   0B??           00482         decfsz  temp_3
034F   2???           00483         goto    $-2
                      00484 ;-----------------------------------------------------------------
0350   2???           00485         goto    Switch_Submenu                          ; И идем отрисовывать подменю, курсор на том же 
                            подпункте
                      00486 
                      00487 ;===================================================================================================
0351                  00488 Zastavka_routine
0351   3001           00489         movlw   CLR_DISP
0352   2???           00490         call    Send_LCD_Command
0353   2???           00491         call    Delay_4ms                                       ; Обязательная задержка после очистки ди
                            сплея !!!
0354   01??           00492         clrf    symbol_pointer
0355                  00493 First_String
0355   2???           00494         call    Table_Zastavka_First_String     
0356   39FF           00495         andlw   0FFh
0357   1903           00496         btfsc   STATUS,Z
0358   2???           00497         goto    Out_First_String
0359   2???           00498         call    Send_LCD_Symbol
Message[305]: Using default destination of 1 (file).
035A   0A??           00499         incf    symbol_pointer  
035B   2???           00500         goto    First_String
035C                  00501 Out_First_String
035C   30C0           00502         movlw   SECOND_LINE     
035D   2???           00503         call    Send_LCD_Command
035E   01??           00504         clrf    symbol_pointer
035F                  00505 Next_String
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

035F   2???           00506         call    Table_Zastavka_Second_String
0360   39FF           00507         andlw   0FFh
0361   1903           00508         btfsc   STATUS,Z
0362   2???           00509         goto    Out_Next_String
0363   2???           00510         call    Send_LCD_Symbol
Message[305]: Using default destination of 1 (file).
0364   0A??           00511         incf    symbol_pointer  
0365   2???           00512         goto    Next_String
0366                  00513 Out_Next_String
0366   2???           00514         goto    Main    
                      00515 
                      00516 ;===================================================================================================
0367                  00517 Debounce_Delay
0367   3002           00518         movlw   .2
0368   00??           00519         movwf   temp_2
0369   01??           00520         clrf    temp_1
036A                  00521 Loop_Delay
036A   0806           00522         movfw   PORTB                                           
036B   380F           00523         iorlw   b'00001111'                                     ; Установим незначущие разряды
036C   3E01           00524         addlw   .1
036D   1D03           00525         btfss   STATUS,Z
036E   2???           00526         goto    Loop_Delay                                      ; Если хоть одна кнопка нажата, просто з
                            ациклимся
Message[305]: Using default destination of 1 (file).
036F   0B??           00527         decfsz  temp_1  
0370   2???           00528         goto    $-1
Message[305]: Using default destination of 1 (file).
0371   0B??           00529         decfsz  temp_2  
0372   2???           00530         goto    Loop_Delay
0373   0008           00531         return
                      00532 
                      00533 ;===================================================================================================
                      00534         end
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 55


SYMBOL TABLE
  LABEL                             VALUE 

C                                 00000000
CLR_DISP                          00000001
CNTL_TRIS_MASK                    000000F5
Check_1                           00000285
Check_2                           000002E4
Correct_index_menu                0000029C
Correct_index_menu_2              000002A9
Correct_index_submenu             000002FE
Correct_index_submenu_2           0000030C
Create_Menu_Names                 
Create_Submenu_Names              
Cursor_DOWN                       000002D0
Cursor_DOWN_submenu               00000335
Cursor_UP                         000002C6
Cursor_UP_submenu                 0000032A
DC                                00000001
DD_RAM_ADDR                       00000080
DD_RAM_UL                         00000080
DISP_OFF                          00000008
DISP_ON                           0000000C
DISP_ON_B                         0000000F
DISP_ON_C                         0000000E
DOWN                              PORTB,5
Debounce_CLR_DISP                 00000265
Debounce_Delay                    00000367
Delay_4ms                         00000000
E                                 00000001
EEADR                             00000009
EECON1                            00000088
EECON2                            00000089
EEDATA                            00000008
EEIE                              00000006
EEIF                              00000004
ENTER                             PORTB,6
ENTER_Menu                        000002DC
ENTER_submenu                     00000342
ENTRY_DEC                         00000004
ENTRY_DEC_S                       00000005
ENTRY_INC                         00000006
ENTRY_INC_S                       00000007
EXIT                              PORTB,7
EXIT_DELAY                        .20
EXIT_Menu                         000002DA
EXIT_submenu                      0000033F
End_Action                        00000344
F                                 00000001
FSR                               00000004
First_String                      00000355
GIE                               00000007
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 56


SYMBOL TABLE
  LABEL                             VALUE 

INTF                              00000001
IRP                               00000007
LCD_CNTL                          00000005
LCD_CNTL_TRIS                     00000085
LCD_DATA                          00000006
LCD_DATA_TRIS                     00000086
Loop_Delay                        0000036A
Loop_Menu                         000002B7
Loop_Submenu                      0000031B
MENU_NAME_1                       "1.Menu_1"
MENU_NAME_2                       "2.Menu_2"
MENU_NAME_3                       "3.Menu_3"
MENU_NAME_4                       "4.Menu_4"
MENU_NAME_5                       "5.Menu_5"
MENU_SUBMENU_NAME_1_1             "1.1.Garage"
MENU_SUBMENU_NAME_1_2             "1.2.Doors"
MENU_SUBMENU_NAME_1_3             "1.3.House"
MENU_SUBMENU_NAME_2_1             "2.1.Garage"
MENU_SUBMENU_NAME_2_2             "2.2.Doors"
MENU_SUBMENU_NAME_2_3             "2.3.House"
MENU_SUBMENU_NAME_3_1             "3.1.Review"
MENU_SUBMENU_NAME_3_2             "3.2.Shut Off"
MENU_SUBMENU_NAME_3_3             "3.3.FAQ"
MENU_SUBMENU_NAME_4_1             "4.1.Review"
MENU_SUBMENU_NAME_4_2             "4.2.Shut Off"
MENU_SUBMENU_NAME_4_3             "4.3.FAQ"
MENU_SUBMENU_NAME_5_1             "5.1.Config"
MENU_SUBMENU_NAME_5_2             "5.2.Settings"
MENU_SUBMENU_NAME_5_3             "5.3.About"
Main                              00000000
Menu_1                            00000095
Menu_1_Submenu_1                  0000013E
Menu_1_Submenu_1_action           00000256
Menu_1_Submenu_2                  00000151
Menu_1_Submenu_2_action           00000257
Menu_1_Submenu_3                  00000163
Menu_1_Submenu_3_action           00000258
Menu_1_Table                      0000001A
Menu_1_Table_action               0000005E
Menu_2                            000000A6
Menu_2_Submenu_1                  00000175
Menu_2_Submenu_1_action           00000259
Menu_2_Submenu_2                  00000188
Menu_2_Submenu_2_action           0000025A
Menu_2_Submenu_3                  0000019A
Menu_2_Submenu_3_action           0000025B
Menu_2_Table                      00000025
Menu_2_Table_action               00000069
Menu_3                            000000B7
Menu_3_Submenu_1                  000001AC
Menu_3_Submenu_1_action           0000025C
Menu_3_Submenu_2                  000001BF
Menu_3_Submenu_2_action           0000025D
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 57


SYMBOL TABLE
  LABEL                             VALUE 

Menu_3_Submenu_3                  000001D4
Menu_3_Submenu_3_action           0000025E
Menu_3_Table                      00000030
Menu_3_Table_action               00000074
Menu_4                            000000C8
Menu_4_Submenu_1                  000001E4
Menu_4_Submenu_1_action           0000025F
Menu_4_Submenu_2                  000001F7
Menu_4_Submenu_2_action           00000260
Menu_4_Submenu_3                  0000020C
Menu_4_Submenu_3_action           00000261
Menu_4_Table                      0000003B
Menu_4_Table_action               0000007F
Menu_5                            000000D9
Menu_5_Submenu_1                  0000021C
Menu_5_Submenu_1_action           00000262
Menu_5_Submenu_2                  0000022F
Menu_5_Submenu_2_action           00000263
Menu_5_Submenu_3                  00000244
Menu_5_Submenu_3_action           00000264
Menu_5_Table                      00000046
Menu_5_Table_action               0000008A
Menu_heandler                     0000027D
NOT_PD                            00000003
NOT_RBPU                          00000007
NOT_TO                            00000004
NUM_OF_MAIN_MENU_PUNKTS           .5
NUM_OF_SUBMENU_PUNKTS_1           .3
NUM_OF_SUBMENU_PUNKTS_2           .3
NUM_OF_SUBMENU_PUNKTS_3           .3
NUM_OF_SUBMENU_PUNKTS_4           .3
NUM_OF_SUBMENU_PUNKTS_5           .3
Next_String                       0000035F
Num_of_Submenu_Table              000000EA
OPTION_REG                        00000081
Only_Write                        00000001
Out_Action_Complete               0000034C
Out_First_String                  0000035C
Out_Next_String                   00000366
PCL                               00000002
PCLATH                            0000000A
PORTA                             00000005
PORTB                             00000006
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
Press_DOWN                        flags,1
Press_ENTER                       flags,3
Press_EXIT                        flags,2
Press_UP                          flags,0
Pressing_DOWN                     000002A1
Pressing_DOWN_2                   00000304
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 58


SYMBOL TABLE
  LABEL                             VALUE 

RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RD                                00000000
RP0                               00000005
RP1                               00000006
RS                                00000003
SECOND_LINE                       000000C0
STATUS                            00000003
Second_String_routine             0000026A
Send_LCD_Command                  00000000
Send_LCD_Symbol                   00000000
Skip_Check_1                      0000028B
Skip_Check_2                      000002ED
Skip_Correct_index_menu_2         000002AE
Skip_Correct_index_menu_3         000002B3
Skip_Correct_index_submenu_2      00000312
Skip_Correct_index_submenu_3      00000317
String_Action_Complete            00000345
String_Menu                       0000026E
String_Submenu                    00000276
Switch_Action                     00000051
Switch_Menu                       0000027E
Switch_Menu_Table                 00000000
Switch_Menu_routine               0000026D
Switch_Submenu                    000002DD
Switch_Submenu_Table              0000000D
Switch_Submenu_routine            00000275
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 59


SYMBOL TABLE
  LABEL                             VALUE 

TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
Table_Action_Complete             00000125
Table_Zastavka_First_String       000000F7
Table_Zastavka_Second_String      0000010E
UP                                PORTB,4
USE_CURSOR                        0
USE_MOVING_CURSOR                 1
USE_SHORT_MOD_PCL                 1
USE_TOP_4_FIRST_AND_BOTTOM_4_LAS  1
Use_4_bit_mode                    00000001
Use_High_Nible                    00000000
Use_One_Port                      00000000
W                                 00000000
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
ZASTAVKA_FIRST_STRING             "  MicroMenuLib"
ZASTAVKA_SECOND_STRING            "  ver 1.0 beta"
Zastavka                          00000000
Zastavka_routine                  00000351
_CONFIG                           00002007
_CP_OFF                           00003FFF
_CP_ON                            0000000F
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_MicroMenu_034F                   0000034F
_MicroMenu_0370                   00000370
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F84                           00000001
MPASM  5.51                 MICROMENU_LIB.ASM   5-24-2017  23:18:34         PAGE 60


SYMBOL TABLE
  LABEL                             VALUE 

add_PCL                           
flags                             00000000
goto_Punkt_Menu                   
goto_Punkt_Submenu                
goto_Punkt_Submenu_action         
index_menu                        00000000
index_submenu                     00000001
known_zero                        00000000
menu_counter                      00000003
mod_PCL                           
n                                 00000000
offset                            00000000
pop                               
push                              
retlw_num_of_submenu_punkts       
symbol_pointer                    00000002
temp_1                            00000004
temp_2                            00000005
temp_3                            00000006
y                                 00000001

Errors   :     0
Warnings :   180 reported,     0 suppressed
Messages :    38 reported,     0 suppressed

